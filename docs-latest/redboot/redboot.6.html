<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD><!--version 1.1/Thu Feb 15 11:33:14  2001--><!--version 1.1/Thu Feb 15 11:32:38  2001-->
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="cygnus.css">
<TITLE> Updating RedBoot</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<TABLE STYLE="ECOS" WIDTH="98%" BORDER="0" ALIGN="LEFT" CELLPADDING="1"><TR><TH COLSPAN="3" ALIGN="center"><P CLASS="Gotos">Updating RedBoot</P></TH></TR><TR><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.html">Contents</A></P></TD><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.5.html">To&nbsp;previous&nbsp;page</A></P></TD><TD ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.7.html">To&nbsp;next&nbsp;page</A></P></TD></TR></TABLE><P ALIGN="LEFT">&nbsp;</P><BR><BR><HR ALIGN="center"></DIV>
<H2 CLASS="ChapterTitle">
<A NAME="pgfId=2639328">
 </A>
<A NAME="marker=2655473">
 </A>
Updating RedBoot<DIV>
<IMG SRC="botclear.gif">
</DIV>
</H2>
<P CLASS="Body">
<A NAME="pgfId=2653887">
 </A>
RedBoot normally runs from FLASH or ROM. In the case of FLASH, it is possible to update RedBoot, that is, replace it with a newer version, in situ. This process is complicated by the fact that RedBoot is running from the very FLASH which is being updated.</P>
<P CLASS="Body">
<A NAME="pgfId=2653888">
 </A>
The following is an outline of the steps needed for updating RedBoot: </P>
<OL>
<P><P><LI>
<A NAME="pgfId=2653889">
 </A>
Start RedBoot, running from FLASH. </LI>
<P><P><LI>
<A NAME="pgfId=2653890">
 </A>
Load and start a different version of RedBoot, running from RAM. </LI>
<P><P><LI>
<A NAME="pgfId=2653891">
 </A>
Update the primary RedBoot FLASH image. </LI>
<P><P><LI>
<A NAME="pgfId=2653892">
 </A>
Reboot; run RedBoot from FLASH.</LI>
</OL>
<P CLASS="Body">
<A NAME="pgfId=2653893">
 </A>
In order to execute this process, two versions of RedBoot are required; one which runs from FLASH, and a separate one which runs solely from RAM. Both of these images are typically provided as part of the RedBoot package, but they may also be rebuilt from source using the instructions provided for the platform.</P>
<P CLASS="Body">
<A NAME="pgfId=2653894">
 </A>
The following is a more detailed look at these steps. For this process, it is assumed that the target is connected to a host system and that there is some sort of serial connection used for the RedBoot CLI.</P>
<H4 CLASS="Heading3">
<A NAME="pgfId=2653895">
 </A>
Start RedBoot, running from FLASH </H4>
<P CLASS="Body">
<A NAME="pgfId=2653896">
 </A>
To start RedBoot, reset the platform.</P>
<H4 CLASS="Heading3">
<A NAME="pgfId=2653897">
 </A>
Load and start a different version of RedBoot, running from RAM </H4>
<P CLASS="Body">
<A NAME="pgfId=2653898">
 </A>
There are a number of choices here. The basic case is where the RAM based version has been stored in the FIS (FLASH Image System). To load and execute this version, use the commands: </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653899"> </A>
RedBoot&gt; fis load RedBoot[backup] 
RedBoot&gt; go</PRE>
<P CLASS="Body">
<A NAME="pgfId=2653900">
 </A>
If this image is not available, or does not work, then an alternate RAM based image must be loaded. Using the <TT CLASS="Code">
load</TT>
 command: </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653901"> </A>
RedBoot&gt; load redboot_RAM.srec </PRE>
<H3 CLASS="Label">
<A NAME="pgfId=2653902">
 </A>
NOTE</H3>
<P CLASS="Note">
<A NAME="pgfId=2653903">
 </A>
The details of how to load are installation specific. The file must be placed somewhere the host computer can provide it to the target RedBoot system. Either TFTP (shown) or X/Ymodem can be used to download the image into RAM. </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653904"> </A>
RedBoot&gt; go</PRE>
<H4 CLASS="Heading3">
<A NAME="pgfId=2653905">
 </A>
Update the primary RedBoot FLASH image </H4>
<P CLASS="Body">
<A NAME="pgfId=2653906">
 </A>
At this point, a new version of RedBoot is running on the target, in RAM. </P>
<P CLASS="Body">
<A NAME="pgfId=2653907">
 </A>
Using the <TT CLASS="Code">
load</TT>
 command, download the FLASH based version from the host. </P>
<P CLASS="Body">
<A NAME="pgfId=2653908">
 </A>
Since the FLASH version is designed to load and run from FLASH, the image must be relocated into some suitable, available, RAM location. The details of this are target platform specific (found in the target appendix), but the command will look something like this: </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653909"> </A>
RedBoot&gt; load redboot_ROM.srec -b 0x00100000 </PRE>
<P CLASS="Body">
<A NAME="pgfId=2653910">
 </A>
This command loads the FLASH image into RAM at 0x00100000, using the TFTP protocol via a network connection. Other options are available, refer to the command section on <TT CLASS="Code">
load</TT>
 for more details.</P>
<P CLASS="Body">
<A NAME="pgfId=2653911">
 </A>
Once the image is loaded into RAM, it must be placed into FLASH using the FIS commands. Some platforms support locking (write protecting) certain regions of the FLASH, while others do not. If your platform does not support the lock/unlock commands, simply ignore these steps. Again, the details of these commands (in particular the numeric values) differ on each target platform, but the ideas are the same: </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653912"> </A>
RedBoot&gt; fis unlock -f 0xA0000000 -l 0x40000 </PRE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653913"> </A>
RedBoot&gt; fis create RedBoot -f 0xA0000000 -b 0x00100000 -l 0x40000 -s 0xCFAE </PRE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2653914"> </A>
RedBoot&gt; fis lock -f 0xA0000000 -l 0x40000 </PRE>
<H3 CLASS="Label">
<A NAME="pgfId=2653915">
 </A>
NOTE </H3>
<P CLASS="Note">
<A NAME="pgfId=2653916">
 </A>
RedBoot will display a number of lines of information as it executes these commands. Also, the <TT CLASS="Code">
size</TT>
 (<TT CLASS="Code">
-s</TT>
) value for the create operation should be determined from the output provided as part of the file download step. </P>
<P CLASS="Note">
<A NAME="pgfId=2653917">
 </A>
It is not required, but it does allow for improved image validity checking in the form of an image checksum.</P>
<H4 CLASS="Heading3">
<A NAME="pgfId=2653918">
 </A>
Reboot; run RedBoot from FLASH </H4>
<P CLASS="Body">
<A NAME="pgfId=2653919">
 </A>
Once the image has been successfully written into the FLASH, simply reboot the target and the new version of RedBoot will be running.</P>
<H3 CLASS="Label">
<A NAME="pgfId=2653920">
 </A>
NOTE</H3>
<P CLASS="Note">
<A NAME="pgfId=2653921">
 </A>
There may be times when RedBoot does not exist on the hardware, thus making step 1 impossible to do. In these cases, it should be possible to get to step 2 by using GDB. If this is possible, the appropriate steps are provided with the target documentation. </P>
<P CLASS="Body">
<A NAME="pgfId=2653867">
 </A>
</P>
<TABLE>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
</TD>
</TR>
</TABLE>
<HR ALIGN="center"><TABLE STYLE="ECOS" WIDTH="98%" BORDER="0" ALIGN="LEFT" CELLPADDING="1"><TR><TH COLSPAN="3" ALIGN="center"><P CLASS="Gotos">Updating RedBoot</P></TH></TR><TR><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.html">Contents</A></P></TD><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.5.html">To&nbsp;previous&nbsp;page</A></P></TD><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.7.html">To&nbsp;next&nbsp;page</A></P></TD></TR></TABLE></BODY>
</HTML>
