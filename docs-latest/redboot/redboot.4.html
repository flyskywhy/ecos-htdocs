<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD><!--version 1.0-generic/Tue Feb  6 14:34:00  2001--><!--version 1.0-generic/Tue Feb  6 14:32:56  2001-->
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="cygnus.css">
<TITLE> RedBoot Commands and Examples</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<TABLE STYLE="ECOS" WIDTH="98%" BORDER="0" ALIGN="LEFT" CELLPADDING="1"><TR><TH COLSPAN="3" ALIGN="center"><P CLASS="Gotos">RedBoot Commands and Examples</P></TH></TR><TR><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.html">Contents</A></P></TD><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.3.html">To&nbsp;previous&nbsp;page</A></P></TD><TD ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.5.html">To&nbsp;next&nbsp;page</A></P></TD></TR></TABLE><P ALIGN="LEFT">&nbsp;</P><BR><BR><HR ALIGN="center"></DIV>
<H2 CLASS="ChapterTitle">
<A NAME="pgfId=2639328">
 </A>
<A NAME="marker=2656463">
 </A>
RedBoot Commands and Examples<DIV>
<IMG SRC="botclear.gif">
</DIV>
</H2>
<P CLASS="Body">
<A NAME="pgfId=2639554">
 </A>
RedBoot provides three basic classes of commands:   </P>
<UL>
<P><P><LI>
<A NAME="pgfId=2639555">
 </A>
Program loading and execution   </LI>
<P><P><LI>
<A NAME="pgfId=2639556">
 </A>
FLASH image and configuration management   </LI>
<P><P><LI>
<A NAME="pgfId=2639557">
 </A>
Miscellaneous commands </LI>
</UL>
<P CLASS="Body">
<A NAME="pgfId=2639558">
 </A>
Given the extensible and configurable nature of eCos and RedBoot, there may be extended or enhanced sets of commands available.</P>
<P CLASS="Body">
<A NAME="pgfId=2639559">
 </A>
The basic format for commands is:   </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639560"> </A>
RedBoot&gt; COMMAND [-S] [-s <KBD CLASS="CodeVariant">val</KBD>
]<KBD CLASS="CodeVariant">operand</KBD>
 </PRE>
<P CLASS="Body">
<A NAME="pgfId=2639561">
 </A>
Commands may require additional information beyond the basic command name. In most cases this additional information is optional, with suitable default values provided if they are not present. The type of information required affects how it is specified:   </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639562"> </A>
<TT CLASS="Code">[-S]     </TT>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2655726">
 </A>
An optional switch. If this switch is present, then some particular action will take place. For example in the command       </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2655727"> </A>
RedBoot&gt; fis init -f     </PRE>
<P CLASS="Body">
<A NAME="pgfId=2655728">
 </A>
the <TT CLASS="Code">
-f</TT>
 switch indicates to perform a full file system initialization. </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639566"> </A>
<TT CLASS="Code">[-s </TT>
<KBD CLASS="CodeVariant">val</KBD>
<TT CLASS="Code">]</TT>
<KBD CLASS="CodeVariant"></KBD>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639567">
 </A>
An optional switch which requires an associated value. For example the command</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639568"> </A>
       RedBoot&gt; load -b 0x00100000 data_file     </PRE>
<P CLASS="Body">
<A NAME="pgfId=2639569">
 </A>
specifies downloading a file (via TFTP) into memory, relocating it to location 0x00100000. </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639570"> </A>
<KBD CLASS="CodeVariant">operand</KBD>
<SPAN CLASS="Bold"> </SPAN>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639571">
 </A>
This format is used in a case where a command has one operand which must always be present  (no <TT CLASS="Code">
-s</TT>
 is required since it is always implied). For example the command       </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639572"> </A>
RedBoot&gt; go 0x10044     </PRE>
<P CLASS="Body">
<A NAME="pgfId=2639573">
 </A>
specifies executing the code starting at location 0x10044.</P>
<P CLASS="Body">
<A NAME="pgfId=2639574">
 </A>
The list of available commands, and their syntax, can be obtained by typing <TT CLASS="Code">
help</TT>
 at the command line:     </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639575"> </A>
RedBoot&gt; <CODE CLASS="CodeOutput">help</CODE>
    
Display (hex dump) a range of memory
    dump -b &lt;location&gt; [-l &lt;length&gt;]    
Execute an image - with MMU off
    exec [-w timeout] [&lt;entry-point&gt;]
Execute an image - with MMU off
    exec [-w timeout] [&lt;entry_point&gt;]     
Manage FLASH images
    fis {cmds}    
Manage configuration kept in FLASH memory
    fconfig [-l]     
Execute code at a location
    go [-w &lt;timeout&gt;] [entry]   
Help about help?       
    help &lt;topic&gt;   
Load a file
   load [-v] [-r] [-b &lt;mem_addr&gt;] &lt;file_name&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId=2656569">
 </A>
Commands can be abbreviated to their shortest unique string. Thus in the list above, <TT CLASS="Code">
d</TT>
, <TT CLASS="Code">
du</TT>
, <TT CLASS="Code">
dum</TT>
 and <TT CLASS="Code">
dump</TT>
 are all valid for the dump command. The <TT CLASS="Code">
fconfig</TT>
 command can be abbreviated <TT CLASS="Code">
fc</TT>
, but <TT CLASS="Code">
f</TT>
 would be ambiguous with <TT CLASS="Code">
fis</TT>
.</P>
<P CLASS="Body">
<A NAME="pgfId=2656570">
 </A>
There is one additional, special command. When RedBoot detects <TT CLASS="Code">
$</TT>
 as the first character in a command, it switches to GDB protocol mode. At this point, the eCos GDB stubs take over, allowing connections from a GDB host. The only way to get back to RedBoot from GDB mode is to restart the platform.</P>
<P CLASS="Body">
<A NAME="pgfId=2639578">
 </A>
The standard RedBoot command set is structured around the bootstrap environment. These commands are designed to be simple to use and remember, while still providing sufficient power and flexibility to be useful. No attempt has been made to render RedBoot as the end-all product. As such, things such as the debug environment are left to other modules, such as GDB stubs, which are typically included in RedBoot.</P>
<P CLASS="Body">
<A NAME="pgfId=2639579">
 </A>
The command set may be also be extended on a platform basis.</P>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId=2654311">
 </A>
<A NAME="34615">
 </A>
<A NAME="marker=2656464">
 </A>
RedBoot Editing Commands</H3>
<P CLASS="Body">
<A NAME="pgfId=2654312">
 </A>
RedBoot uses the following line editing commands.</P>
<UL>
<P><P><LI>
<A NAME="pgfId=2654313">
 </A>
<SPAN CLASS="Bold">
Delete</SPAN>
 (0x7F) or <SPAN CLASS="Bold">
Backspace</SPAN>
 (0x08) moves the cursor back one character and erases what is there destructively.</LI>
</UL>
<P CLASS="BulletedFollow">
<A NAME="pgfId=2654315">
 </A>
The mention of ^ is in the context of the <TT CLASS="Code">
fconfig</TT>
 command. This command uses some special line-editing features. When certain characters appear alone on the input line, a behavior is elicited.</P>
<UL>
<P><P><LI>
<A NAME="pgfId=2654316">
 </A>
<SPAN CLASS="Bold">
^</SPAN>
 (caret) switch to editing the previous item in the fconfig list. If fconfig edits item A, followed by item B, pressing ^ when changing item B, allows you to change item A. This is similar to the up arrow.</LI>
<P><P><LI>
<A NAME="pgfId=2654318">
 </A>
<SPAN CLASS="Bold">
.</SPAN>
 (period) stop editing any further items. This does not change the current item.</LI>
<P><P><LI>
<A NAME="pgfId=2654320">
 </A>
<SPAN CLASS="Bold">
Return</SPAN>
 (blank line) leaves the value for this item unchanged. Currently it is not possible to step through the value for the start-up script; it must always be retyped.</LI>
</UL>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId=2639580">
 </A>
<A NAME="marker=2656465">
 </A>
Common Commands:</H3>
<P CLASS="Body">
<A NAME="pgfId=2655767">
 </A>
The general format of commands is:   </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2655768"> </A>
<KBD CLASS="CodeVariant">command</KBD>
 &lt;<KBD CLASS="CodeVariant">options</KBD>
, <KBD CLASS="CodeVariant">parameters</KBD>
&gt; </PRE>
<P CLASS="Body">
<A NAME="pgfId=2655769">
 </A>
Elements are separated by the space character. Other control characters, such as <SPAN CLASS="Bold">
Tab</SPAN>
 or editing keys (<SPAN CLASS="Bold">
Insert</SPAN>
) are not currently supported.</P>
<P CLASS="Body">
<A NAME="pgfId=2639584">
 </A>
Numbers, such as a memory location, may be specified in either decimal or hexadecimal (requires a 0x prefix).</P>
<P CLASS="Body">
<A NAME="pgfId=2639585">
 </A>
Commands may be abbreviated to any unique string. For example, <TT CLASS="Code">
lo</TT>
 is equivalent to <TT CLASS="Code">
loa</TT>
 and <TT CLASS="Code">
load</TT>
.</P>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId=2639586">
 </A>
<A NAME="marker=2656466">
 </A>
Download Process</H3>
<P CLASS="Body">
<A NAME="pgfId=2639587">
 </A>
The load command is used to download data into the target system. Data can be loaded via a network connection, using either the TFTP protocol, or the console serial connection using the X/Y modem protocol. Files to be downloaded may either be executable images in SREC format or raw data. The format of the command is:</P>
<P CLASS="Body">
<A NAME="pgfId=2639588">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639589"> </A>
<CODE CLASS="CodeOutput">load file [-v] [-b location] [-r] [-m {xmodem | ymodem | tftp}]
     [-h host_IP_address]</CODE>
<A NAME="marker=2656467"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639618">
 </A>
where:   </P>
<TABLE>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639592">
 </A>
<KBD CLASS="CodeVariant">
file</KBD>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639594">
 </A>
The name of the file on the TFTP server. Details of how this is specified are host-specific. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639596">
 </A>
<TT CLASS="Code">
-v    </TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639598">
 </A>
Display a small spinner (indicator) while the download is in  progress. This is just for feedback, especially during long loads. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639600">
 </A>
<TT CLASS="Code">
-b   </TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639602">
 </A>
Specify the location in memory to which the file should be loaded. Executable images normally load at the location to which the file was linked. This option allows the file to be loaded to a specific memory location, possibly overriding any assumed location. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639604">
 </A>
<TT CLASS="Code">
-r   </TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639606">
 </A>
Download raw data. Normally, the load command is used to load executable images into memory. This option allows for raw data to be loaded. If this option is given, <TT CLASS="Code">
-b</TT>
 will also be required.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639608">
 </A>
<TT CLASS="Code">
-m</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639610">
 </A>
The <TT CLASS="Code">
-m</TT>
 option is used to select the download method. The choices are: </P>
<P CLASS="CellBody">
<A NAME="pgfId=2639611">
 </A>
</P>
<P CLASS="CellBody">
<A NAME="pgfId=2639612">
 </A>
<TT CLASS="Code">
xmodem, ymodem</TT>
 - serial download using standard protocols over the console serial port. When using this method, the &lt;file&gt; parameter is not required.</P>
<P CLASS="CellBody">
<A NAME="pgfId=2639613">
 </A>
<TT CLASS="Code">
tftp</TT>
 - network based download using the TFTP protocol.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639615">
 </A>
<TT CLASS="Code">
-h</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639617">
 </A>
Used explicitly to name a host computer to contact for the download data. This works in TFTP mode only.</P>
</TD>
</TR>
</TABLE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639619"> </A>
=============================================================
RedBoot&gt; lo redboot.ROM -b 0x8c400000       
Address offset = 0x0c400000     
Entry point: 0x80000000, address range: 0x80000000-0x8000fe80     =============================================================</PRE>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId=2639620">
 </A>
<A NAME="marker=2656470">
 </A>
FLASH Image System (FIS)</H3>
<P CLASS="Body">
<A NAME="pgfId=2639621">
 </A>
If the platform has FLASH memory, RedBoot can use this for image storage. Executable images, as well as data, can be stored in FLASH in a simple file store. The <TT CLASS="Code">
fis</TT>
 command is used to manipulate and maintain FLASH images.</P>
<P CLASS="Body">
<A NAME="pgfId=2639622">
 </A>
The available <TT CLASS="Code">
fis</TT>
 commands are:</P>
<P CLASS="Body">
<A NAME="pgfId=2639623">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639624"> </A>
<CODE CLASS="CodeOutput">fis init [-f]</CODE>
<A NAME="marker=2656471"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639625">
 </A>
This command is used to initialize the FLASH Image System (FIS). It should only be executed once, when RedBoot is first installed on the hardware. Subsequent executions will cause loss of data in the FLASH (previously saved images will no longer be accessible).</P>
<P CLASS="Body">
<A NAME="pgfId=2639626">
 </A>
If the<TT CLASS="Code">
 -f</TT>
 option is specified, all blocks of FLASH memory will be erased as part of this process.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639627"> </A>
    =================================================================
RedBoot&gt; fis init -f     
About to initialize [format] FLASH image system - are you sure (y/n)? n
=================================================================</PRE>
<P CLASS="Body">
<A NAME="pgfId=2655657">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639629"> </A>
<CODE CLASS="CodeOutput">fis [-c] list </CODE>
<A NAME="marker=2656472"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639630">
 </A>
This command lists the images currently available in the FIS. Certain images used by RedBoot have fixed names. Other images can be manipulated by the user.</P>
<P CLASS="Body">
<A NAME="pgfId=2639631">
 </A>
If the <TT CLASS="Code">
-c</TT>
 option is specified, the image checksum is displayed instead of  the <TT CLASS="Code">
Mem Addr</TT>
 field.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2655503"> </A>
    =================================================================
RedBoot&gt; fis list
Name           FLASH addr  Mem addr   Length   Entry point
RedBoot        0xA0000000  0xA0000000 0x020000 0x80000000
RedBoot[backup]0xA0020000  0x8C010000 0x010000 0x8C010000
RedBoot config 0xA0FC0000  0xA0FC0000 0x020000 0x00000000
FIS directory  0xA0FE0000  0xA0FE0000 0x020000 0x00000000
RedBoot&gt; fis list -c
Name           FLASH addr  Checksum   Length   Entry point
RedBoot        0xA0000000  0x34C94A57 0x020000 0x80000000
RedBoot[backup]0xA0020000  0x00000000 0x010000 0x8C010000
RedBoot config 0xA0FC0000  0x00000000 0x020000 0x00000000
RedBoot config 0xA0FE0000  0x00000000 0x020000 0x00000000
=================================================================</PRE>
<P CLASS="Body">
<A NAME="pgfId=2655661">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639644"> </A>
<CODE CLASS="CodeOutput">fis free </CODE>
<A NAME="marker=2656473"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639645">
 </A>
This command shows which areas of the FLASH memory are currently not in use. In use means that the block contains non-erased contents. Since it is possible to force an image to be loaded at a particular FLASH location, this command can be used to check whether that location is in use by any other image.</P>
<H3 CLASS="Label">
<A NAME="pgfId=2639646">
 </A>
Note: </H3>
<P CLASS="Note">
<A NAME="pgfId=2639647">
 </A>
There is currently no cross-checking between actual FLASH contents and the image directory, which mans that there could be a segment of FLASH which is not erased that does not correspond to a named image, or vice-versa.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639648"> </A>
    =================================================================
RedBoot&gt; fis free
       0xA0040000 .. 0xA07C0000
       0xA0840000 .. 0xA0FC0000     
=================================================================</PRE>
<P CLASS="Body">
<A NAME="pgfId=2655669">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2656547"> </A>
<CODE CLASS="CodeOutput">fis create -b &lt;mem_base&gt; -l &lt;length&gt; [-f &lt;flash_addr&gt;] [-e &lt;entry_point&gt;] 
[-r &lt;ram_addr&gt;] [-s &lt;data_length&gt;] [-n] &lt;name&gt;</CODE>
<A NAME="marker=2656546"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2656548">
 </A>
This command creates an image in the FIS directory. The data for the image must exist in RAM memory before the copy. Typically, you would use the RedBoot <TT CLASS="Code">
load</TT>
 command to load an image into RAM and then the <TT CLASS="Code">
fis create</TT>
 command to write it to FLASH. </P>
<P CLASS="Body">
<A NAME="pgfId=2639681">
 </A>
Options:   </P>
<TABLE>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639654">
 </A>
<KBD CLASS="CodeVariant">
name</KBD>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639656">
 </A>
The name of the file, as shown in the FIS directory. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639658">
 </A>
<TT CLASS="Code">
-b</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639660">
 </A>
The location in RAM used to obtain the image. This is a required option. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639662">
 </A>
<TT CLASS="Code">
-l</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639664">
 </A>
The length of the image. This is a required option. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639666">
 </A>
<TT CLASS="Code">
-f</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639668">
 </A>
The location in FLASH for the image. If this is not provided, the first freeVblock which is large enough will be used. See<TT CLASS="Code">
 fis free</TT>
. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639670">
 </A>
<TT CLASS="Code">
-e</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639672">
 </A>
The execution entry address. This is used if the starting address for an image is not known, or needs to be overridden. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639674">
 </A>
<TT CLASS="Code">
-r</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639676">
 </A>
The location in RAM when the image is loaded via <TT CLASS="Code">
fis load</TT>
. This only needs to be specified for images which will eventually loaded via <TT CLASS="Code">
fis load</TT>
. Fixed images, such as RedBoot itself, will not need this.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639678">
 </A>
<TT CLASS="Code">
-s</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2639680">
 </A>
The length of the actual data to be written to FLASH. If not present then the image length (<TT CLASS="Code">
-1</TT>
) value is assumed. If the value given by <TT CLASS="Code">
-s</TT>
 is less than <TT CLASS="Code">
-1</TT>
, the remainder of the image in FLASH will be left in an erased state. Note that by using this option it is possible to create a completely empty FLASH image, for example to reserve space for use by applications other than RedBoot.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655335">
 </A>
<TT CLASS="Code">
-n</TT>
</P>
<P CLASS="CellBody">
<A NAME="pgfId=2655325">
 </A>
<TT CLASS="Code">
</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655327">
 </A>
If <TT CLASS="Code">
-n</TT>
 is specified, then only the FIS directory is updated, and no data is copied from RAM to FLASH. This feature can be used to recreate the FIS entry if it has been destroyed.</P>
</TD>
</TR>
</TABLE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639682"> </A>
    =================================================================
RedBoot&gt; fis create RedBoot -f 0xa0000000 -b 0x8c400000 -l 0x20000     
An image named 'RedBoot' exists - are you sure (y/n)? n     
RedBoot&gt; fis create junk -b 0x8c400000 -l 0x20000
... Erase from 0xa0040000-0xa0060000: .
... Program from 0x8c400000-0x8c420000 at 0xa0040000: .
... Erase from 0xa0fe0000-0xa1000000: .
... Program from 0x8c7d0000-0x8c7f0000 at 0xa0fe0000: .
=================================================================</PRE>
<P CLASS="Body">
<A NAME="pgfId=2655670">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639684"> </A>
<CODE CLASS="CodeOutput">fis load [-b &lt;memory load address&gt;] [-c] name</CODE>
<A NAME="marker=2656475"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639685">
 </A>
This command is used to transfer an image from FLASH memory to RAM. Once loaded, it may be executed using the <TT CLASS="Code">
go</TT>
 command. If <TT CLASS="Code">
-b</TT>
 is specified, then the image is copied from FLASH to the specified address in RAM. If -b is not specified, the image is copied from FLASH to the load address given when the image was created.</P>
<TABLE>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655426">
 </A>
<KBD CLASS="CodeVariant">
name</KBD>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655428">
 </A>
The name of the file, as shown in the FIS directory</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655430">
 </A>
<TT CLASS="Code">
-b   </TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655432">
 </A>
Specify the location in memory to which the file should be loaded. Executable images normally load at the location to which the file was linked. This option allows the file to be loaded to a specific memory location, possibly overriding any assumed location. </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655434">
 </A>
<TT CLASS="Code">
-c</TT>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=2655436">
 </A>
Compute and print the checksum of the image data after it has been loaded into memory.</P>
</TD>
</TR>
</TABLE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639691"> </A>
    =================================================================
RedBoot&gt; fis load RedBoot[backup]     
RedBoot&gt; go     
================================================================</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639692">
 </A>
</P>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639693"> </A>
<CODE CLASS="CodeOutput">fis delete name</CODE>
<A NAME="marker=2656476"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639694">
 </A>
This command removes an image from the FIS. The FLASH memory will be erased as part of the execution of this command, as well as removal of the name from the FIS directory.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639695"> </A>
    =================================================================
RedBoot&gt; fis list     
Name              FLASH addr   Mem addr    Length    Entry point     
RedBoot          0xA0000000   0xA0000000  0x020000  0x80000000     
RedBoot[backup]  0xA0020000   0x8C010000  0x020000  0x8C010000     
RedBoot config   0xA0FC0000   0xA0FC0000  0x020000  0x00000000     
FIS directory    0xA0FE0000   0xA0FE0000  0x020000  0x00000000     
junk             0xA0040000   0x8C400000  0x020000  0x80000000     
RedBoot&gt; fis delete junk     
Delete image 'junk' - are you sure (y/n)? y     
... Erase from 0xa0040000-0xa0060000: . 
... Erase from 0xa0fe0000-0xa1000000: . 
... Program from 0x8c7d0000-0x8c7f0000 at 0xa0fe0000: .
=================================================================</PRE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639696"> </A>
<CODE CLASS="CodeOutput"></CODE>
</PRE>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639697"> </A>
<CODE CLASS="CodeOutput">fis lock -f &lt;flash_addr&gt; -l &lt;length&gt;</CODE>
<A NAME="marker=2656477"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639698">
 </A>
This command is used to write-protect (lock) a portion of FLASH memory, to prevent accidental overwriting of images. In order to make make any modifications to the FLASH, a matching unlock command must be issued. This command is optional and will only be provided on hardware which can support write-protection of the FLASH space. </P>
<H3 CLASS="Label">
<A NAME="pgfId=2639699">
 </A>
Note</H3>
<P CLASS="Note">
<A NAME="pgfId=2639700">
 </A>
Depending on the system, attempting to write to write-protected FLASH may generate errors or warnings, or be benignly quiet.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2655830"> </A>
 =================================================================
RedBoot fis lock -f 0xa0040000 -l 0x20000 
... Lock from 0xa0040000-0xa0060000: . 
=================================================================</PRE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639702"> </A>
<CODE CLASS="CodeOutput"></CODE>
</PRE>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639703"> </A>
<CODE CLASS="CodeOutput">fis unlock -f &lt;flash_addr&gt; -l &lt;length&gt;</CODE>
<A NAME="marker=2656478"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639704">
 </A>
This command is used to unlock a portion of FLASH memory forcibly, allowing it to be updated. It must be issued for regions which have been locked before the FIS can reuse those portions of FLASH.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639705"> </A>
 =================================================================
RedBoot fis unlock -f 0xa0040000 -l 0x20000 
... Unlock from 0xa0040000-0xa0060000: . 
=================================================================</PRE>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639706"> </A>
<CODE CLASS="CodeOutput"></CODE>
</PRE>
<PRE CLASS="CodeExampleWide"><A NAME="pgfId=2639707"> </A>
<CODE CLASS="CodeOutput">fis erase -f &lt;flash_addr&gt; -l &lt;length&gt;</CODE>
<A NAME="marker=2656479"> </A>
</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639708">
 </A>
This command is used to erase a portion of FLASH memory forcibly. There is no cross-checking to ensure that the area being erased does not correspond to a loaded image.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639709"> </A>
    =================================================================
RedBoot&gt; fis erase -f 0xa0040000 -l 0x20000     
... Erase from 0xa0040000-0xa0060000: . 
=================================================================</PRE>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId=2639711">
 </A>
<A NAME="marker=2656480">
 </A>
Persistent State FLASH-based Configuration and Control</H3>
<P CLASS="Body">
<A NAME="pgfId=2639712">
 </A>
If the platform has FLASH memory, certain control and configuration information used by RedBoot can be stored in FLASH. The details of what information is maintained in FLASH differs, based on the platform and the configuration. However, the basic operation used to maintain this information is the same. Using the <TT CLASS="Code">
fconfig -1</TT>
 command, the information may be displayed and/or changed.</P>
<P CLASS="Body">
<A NAME="pgfId=2639713">
 </A>
If the optional flag <TT CLASS="Code">
-l</TT>
 is specified, the configuration data is simply listed. Otherwise, each configuration parameter will be displayed and you are given a chance to change it.The entire value must be typed - typing just carriage return will leave a value unchanged. Boolean values may be entered using the first letter (<TT CLASS="Code">
t</TT>
 for true, <TT CLASS="Code">
f </TT>
for false). At any time the editing process may be stopped simply by entering a period (.) on the line. Entering the caret (<TT CLASS="Code">
^)</TT>
 moves the editing back to the previous item. See <A HREF="redboot.4.html#34615" CLASS="XRef">
 RedBoot Editing Commands</A>
.</P>
<P CLASS="Body">
<A NAME="pgfId=2639714">
 </A>
If any changes are made in the configuration, then the updated data will be written back to FLASH after getting acknowledgement from the user.</P>
<P CLASS="Body">
<A NAME="pgfId=2639715">
 </A>
One item which is always present in the configuration data is the ability to execute a script at boot time. A sequence of RedBoot commands can be entered which will be executed when the system starts up. Optionally, a time-out period can be provided which allows the user to abort the startup script and proceed with normal command processing from the console.</P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639716"> </A>
    =================================================================
RedBoot&gt; fconfig -l     
Run script at boot: false     
Use BOOTP for network configuration: false     
Local IP address: 192.168.1.29     
Default server IP address: 192.168.1.101     
GDB connection port: 9000     
Network debug at boot time: false     =================================================================</PRE>
<P CLASS="Body">
<A NAME="pgfId=2639717">
 </A>
</P>
<P CLASS="Body">
<A NAME="pgfId=2639718">
 </A>
The following example sets a boot script and then shows it running. </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639719"> </A>
   =================================================================
RedBoot&gt; <CODE CLASS="CodeOutput">fconfig </CODE>
    
Run script at boot: false t                          ^
     Boot script:     
Enter script, terminate with empty line     
&gt;&gt; <CODE CLASS="CodeOutput">fi li </CODE>

  Boot script timeout: 0 <CODE CLASS="CodeOutput">10 </CODE>
                            
Use BOOTP for network configuration: false . 
Update RedBoot non-volatile configuration - are you sure (y/n)? y                                                                
... Erase from 0xa0fc0000-0xa0fe0000: . 
... Program from 0x8c021f60-0x8c022360 at 0xa0fc0000: .
RedBoot&gt;     
RedBoot(tm) debug environment - built 08:22:24, Aug 23 2000
Copyright (C) 2000, Red Hat, Inc. 

RAM: 0x8c000000-0x8c800000     
FLASH: 0xa0000000 - 0xa1000000, 128 blocks of 0x00020000 bytes ea. 
Socket Communications, Inc: Low Power Ethernet CF Revision C 5V/3.3V 08/27/98     
IP: 192.168.1.29, Default server: 192.168.1.101     
== Executing boot script in 10 seconds - enter ^C to abort     
RedBoot&gt; fi li     
Name              FLASH addr   Mem addr    Length    Entry point     
RedBoot          0xA0000000   0xA0000000  0x020000  0x80000000     
RedBoot[backup]  0xA0020000   0x8C010000  0x020000  0x8C010000     
RedBoot config   0xA0FC0000   0xA0FC0000  0x020000  0x00000000     
FIS directory    0xA0FE0000   0xA0FE0000  0x020000  0x00000000     
RedBoot&gt;              
        
=================================================================</PRE>
<H3 CLASS="Label">
<A NAME="pgfId=2639720">
 </A>
NOTE </H3>
<P CLASS="Note">
<A NAME="pgfId=2639721">
 </A>
The bold characters above indicate where something was entered on the console. As you can see, the <TT CLASS="Code">
fi li</TT>
 command at the end came from the script, not the console. Once the script is executed, command processing reverts to the console.</P>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId=2639722">
 </A>
<A NAME="marker=2656481">
 </A>
Executing Programs from RedBoot</H3>
<P CLASS="Body">
<A NAME="pgfId=2639723">
 </A>
Once an image has been loaded into memory, either via the <TT CLASS="Code">
load</TT>
 command or the <TT CLASS="Code">
fis load</TT>
 command, execution may be transfered to that image. </P>
<H3 CLASS="Label">
<A NAME="pgfId=2639724">
 </A>
Note: </H3>
<P CLASS="Note">
<A NAME="pgfId=2639725">
 </A>
The image is assumed to be a stand-alone entity, as RedBoot gives the entire platform over to it. Typical examples would be an eCos application or a Linux kernel.</P>
<P CLASS="Body">
<A NAME="pgfId=2639726">
 </A>
The format of the <TT CLASS="Code">
go</TT>
 command is:   </P>
<PRE CLASS="CodeExample"><A NAME="pgfId=2639727"> </A>
RedBoot&gt; go [-w <KBD CLASS="CodeVariant">time</KBD>
] [<KBD CLASS="CodeVariant">location</KBD>
] </PRE>
<P CLASS="Body">
<A NAME="pgfId=2639728">
 </A>
Execution will begin at <TT CLASS="Code">
location</TT>
 if specified. Otherwise, the entry point of the last image loaded will be used.</P>
<P CLASS="Body">
<A NAME="pgfId=2654156">
 </A>
The -<TT CLASS="Code">
w</TT>
 option gives the user <TT CLASS="Code">
time</TT>
 seconds before execution begins. The execution may be aborted by typing <SPAN CLASS="Bold">
Ctrl+C</SPAN>
 on the console. This mode would typically be used in startup scripts.</P>
<P CLASS="Body">
<A NAME="pgfId=2653867">
 </A>
</P>
<TABLE>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
</TD>
</TR>
</TABLE>
</DIV>
<HR ALIGN="center"><TABLE STYLE="ECOS" WIDTH="98%" BORDER="0" ALIGN="LEFT" CELLPADDING="1"><TR><TH COLSPAN="3" ALIGN="center"><P CLASS="Gotos">RedBoot Commands and Examples</P></TH></TR><TR><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.html">Contents</A></P></TD><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.3.html">To&nbsp;previous&nbsp;page</A></P></TD><TD  ALIGN="center"><P CLASS="Gotos"><A HREF="redboot.5.html">To&nbsp;next&nbsp;page</A></P></TD></TR></TABLE></BODY>
</HTML>
