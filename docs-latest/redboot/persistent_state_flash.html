<!-- Copyright (C) 2001 Red Hat, Inc.                                -->
<!-- This material may be distributed only subject to the terms      -->
<!-- and conditions set forth in the Open Publication License, v1.0  -->
<!-- or later (the latest version is presently available at          -->
<!-- http://www.opencontent.org/openpub/)                            -->
<!-- Distribution of substantively modified versions of this         -->
<!-- document is prohibited without the explicit permission of the   -->
<!-- copyright holder.                                               -->
<!-- Distribution of the work or derivative of the work in any       -->
<!-- standard (paper) book form is prohibited unless prior           -->
<!-- permission obtained from the copyright holder                   -->
<HTML
><HEAD
><TITLE
>Persistent State Flash-based Configuration and Control</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.54"><LINK
REL="HOME"
TITLE="RedBoot&#8482; User's Guide"
HREF="redboot.html"><LINK
REL="UP"
TITLE="RedBoot Commands and Examples"
HREF="redboot_commands_and_examples.html"><LINK
REL="PREVIOUS"
TITLE="Flash Image System (FIS)"
HREF="flash_image_system.html"><LINK
REL="NEXT"
TITLE="Executing Programs from RedBoot"
HREF="executing_programs.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>RedBoot&#8482; User's Guide: Document Version 1.3, April 2001</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="flash_image_system.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 2. RedBoot Commands and Examples</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="executing_programs.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="PERSISTENT_STATE_FLASH"
>Persistent State Flash-based Configuration and Control</A
></H1
><P
></P
><P
>RedBoot provides flash management support for storage in the flash memory
of multiple executable images and of non-volatile information such as IP addresses
and other network information.</P
><P
>See other fis commands in <A
HREF="flash_image_system.html"
>the section called <I
>Flash Image System (FIS)</I
></A
>.</P
><P
>Certain control and configuration information used by RedBoot can be
stored in flash. </P
><P
>The details of what information is maintained in flash differs, based
on the platform and the configuration. However, the basic operation used to
maintain this information is the same. Using the <TT
CLASS="COMPUTEROUTPUT"
>fconfig -l</TT
> command, the information may be displayed and/or changed. </P
><P
>If the optional flag <TT
CLASS="COMPUTEROUTPUT"
>-l</TT
> is specified,
the configuration data is simply listed. Otherwise, each configuration parameter
will be displayed and you are given a chance to change it. The entire value
must be typed - typing just carriage return will leave a value unchanged.
Boolean values may be entered using the first letter (<TT
CLASS="COMPUTEROUTPUT"
>t</TT
>
for true, <TT
CLASS="COMPUTEROUTPUT"
>f</TT
> for false). At any time the editing
process may be stopped simply by entering a period (.) on the line. Entering
the caret (^) moves the editing back to the previous item. See &#8220;RedBoot
Editing Commands&#8221;, <A
HREF="redboot_editing_commands.html"
>the section called <I
>RedBoot Editing Commands</I
></A
>. </P
><P
>If any changes are made in the configuration, then the updated data
will be written back to flash after getting acknowledgement from the user. </P
><P
>One item which is always present in the configuration data is the ability
to execute a script at boot time. A sequence of RedBoot commands can be entered
which will be executed when the system starts up. Optionally, a time-out period
can be provided which allows the user to abort the startup script and proceed
with normal command processing from the console.     </P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>================================================================= 
RedBoot&#62; <TT
CLASS="USERINPUT"
><B
>fconfig</B
></TT
> -l      
Run script at boot: false      
Use BOOTP for network configuration: false      
Local IP address: 192.168.1.29      
Default server IP address: 192.168.1.101      
GDB connection port: 9000      
Network debug at boot time: false     
=================================================================</PRE
></TD
></TR
></TABLE
></P
><P
>The following example sets a boot script and then shows it running.
    </P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>================================================================= 
RedBoot&#62; <TT
CLASS="USERINPUT"
><B
>fconfig</B
></TT
>      
Run script at boot: false t                          ^
      Boot script:      
Enter script, terminate with empty line
&#62;&#62; <TT
CLASS="USERINPUT"
><B
>fi li</B
></TT
>
    Boot script timeout: 0 <TT
CLASS="USERINPUT"
><B
>10</B
></TT
>
Use BOOTP for network configuration: false .  
Update RedBoot non-volatile configuration - are you sure (y/n)?<TT
CLASS="USERINPUT"
><B
>y</B
></TT
>                                                                 
... Erase from 0xa0fc0000-0xa0fe0000: .  
... Program from 0x8c021f60-0x8c022360 at 0xa0fc0000: . 
RedBoot&#62;      
RedBoot(tm) debug environment - built 08:22:24, Aug 23 2000 
Copyright (C) 2000, Red Hat, Inc.   

RAM: 0x8c000000-0x8c800000      
flash: 0xa0000000 - 0xa1000000, 128 blocks of 0x00020000 bytes ea.
Socket Communications, Inc: Low Power Ethernet CF Revision C \
5V/3.3V 08/27/98 IP: 192.168.1.29, Default server: 192.168.1.101 \
== Executing boot script in 10 seconds - enter ^C to abort      
RedBoot&#62; fi li      
Name              flash addr   Mem addr    Length    Entry point
RedBoot          0xA0000000   0xA0000000  0x020000  0x80000000
RedBoot[backup]  0xA0020000   0x8C010000  0x020000  0x8C010000
RedBoot config   0xA0FC0000   0xA0FC0000  0x020000  0x00000000
FIS directory    0xA0FE0000   0xA0FE0000  0x020000  0x00000000
RedBoot&#62;                        
=================================================================</PRE
></TD
></TR
></TABLE
> </P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>NOTE:: </B
>The bold characters above indicate where something was entered on the
console. As you can see, the fi li command at the end came from the script,
not the console. Once the script is executed, command processing reverts to
the console. </P
></BLOCKQUOTE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="flash_image_system.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="redboot.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="executing_programs.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Flash Image System (FIS)</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="redboot_commands_and_examples.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Executing Programs from RedBoot</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>