<HTML>
<HEAD>
<TITLE>RedBoot CDL</TITLE>
</HEAD>

<!--#include virtual="../../include/header.html"-->

<H2>RedBoot CDL</H2>
<HR SIZE=3>

<p>The RedBoot package takes care of building RedBoot. The
platform CDL may be used to provide platform-specific RedBoot
commands, and additional file conversion steps after the RedBoot ELF
image file has been built.</p>

<p>The platform RedBoot CDL should be put in a component like the
below, which is disabled when the RedBoot package is not included.</p>

<pre>
    cdl_component CYGPKG_REDBOOT_HAL_OPTIONS {
        display       "Redboot HAL options"
        flavor        none
        no_define
        parent        CYGPKG_REDBOOT
        active_if     CYGPKG_REDBOOT
        description   "
            This option lists the target's requirements for a valid Redboot
            configuration."
    }
</pre>

<h3>Platform Specific RedBoot Commands</h3>

<p>If you are adding extra commands to RedBoot, you need to add a
<tt>compile</tt> statement to the CDL. For instance, to build the file
<tt>redboot_cmds.c</tt> and include it in the RedBoot image, add this
to the above CDL component:</p>

<pre>
            compile -library=libextras.a redboot_cmds.c
</pre>


<h3>Extra build steps</h3>

<p>The example build rule below takes the final redboot ELF image and
converts it to both binary and SREC format, in preparation for being
put into flash or ROM. You may have to tweak those rules or add more,
depending on the method you use to get the data into the target.</p>

<pre>
        cdl_option CYGBLD_BUILD_REDBOOT_BIN {
            display       "Build Redboot ROM binary image"
            active_if     CYGBLD_BUILD_REDBOOT
            default_value 1
            no_define
            description "This option enables the conversion of the Redboot ELF
                         image to a binary image suitable for ROM programming."

            make -priority 325 {
                &lt;PREFIX&gt;/bin/redboot.bin : &lt;PREFIX&gt;/bin/redboot.elf
                $(OBJCOPY) --strip-debug $&lt; $(@:.bin=.img) 
                $(OBJCOPY) -O srec $&lt; $(@:.bin=.srec)
                $(OBJCOPY) -O binary $&lt; $@
            }
        }
</pre>

<!--#include virtual="../../include/footer.html"-->
