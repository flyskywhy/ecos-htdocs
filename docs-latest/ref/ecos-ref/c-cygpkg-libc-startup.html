<HTML
><HEAD
><TITLE
>Component: ISO C startup/termination</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.33"><LINK
REL="HOME"
TITLE="eCos Reference
Manual"
HREF="ecos-ref.html"><LINK
REL="UP"
TITLE="Package: C library"
HREF="p-cygpkg-libc.html"><LINK
REL="PREVIOUS"
TITLE="Component: Signals"
HREF="c-cygpkg-libc-signals.html"><LINK
REL="NEXT"
TITLE="Component: errno"
HREF="c-cygpkg-libc-errno.html"></HEAD
><BODY
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
><SPAN
CLASS="TRADEMARK"
>eCos</SPAN
><SUP
><FONT
SIZE="-4"
>TM</FONT
></SUP
> Reference
Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="c-cygpkg-libc-signals.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 20. Package: C library</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="c-cygpkg-libc-errno.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="C-CYGPKG-LIBC-STARTUP"
>Component: ISO C startup/termination</A
></H1
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGPKG_LIBC_STARTUP</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Dummy</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This component manages the control of the environment (in the general
sense) that the C library provides for use for full ISO C compatibility,
including a main() entry point supplied with arguments and an environment
(as retrievable by the getenv() function). It also includes at the
other end of things, what happens when main() returns or exit() is
called.
      </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="O-CYGDAT-LIBC-ARGUMENTS"
>Option: Arguments to main()</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGDAT_LIBC_ARGUMENTS</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>String</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option allows the setting of the arguments to the main function.
This only has any effect when cyg_iso_c_start() is used to start the
ISO C compatibility. This will automatically invoke main() in an ISO
C compatible fashion. This option is in fact used as argv, and so
is an n-tuple of string constants. The final entry must be NULL. Conventionally
if argv[0] is supplied, it is used to inform the program of its name.
      </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="C-CYGSEM-LIBC-STARTUP-MAIN-THREAD"
>Component: main() invoked as thread</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGSEM_LIBC_STARTUP_MAIN_THREAD</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>It is normally expected (e.g. in a POSIX 1003.1 environment) that
main() is run in the context of a thread just like any other thread.
If this option is disabled then main() will instead be called in the
context of the initialization routines, without the scheduler running
and using the interrupt stack. This means that any functions that
may require interactions with a running kernel will not work (including
libc functions, if configured to be thread safe for example), so you
should restrict yourself to only calling fully re-entrant functions
from within main() in this case.
      </P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="C-CYGSEM-LIBC-MAIN-STACK-FROM-SYSTEM"
>Component: System provides stack for main()'s thread</A
></H3
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGSEM_LIBC_MAIN_STACK_FROM_SYSTEM</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option controls whether the stack of main()'s thread is provided
by the application or provided by the system. When disabled, the application
must declare a pointer variable cyg_libc_main_stack which is a pointer
to an appropriately aligned region of memory. The application must
also declare a variable of type `int' called cyg_libc_main_stack_size
which contains the size of the stack in bytes. This must be a multiple
of 8.
      </P
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="O-CYGNUM-LIBC-MAIN-DEFAULT-STACK-SIZE"
>Option: main()'s default thread stack size</A
></H4
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGNUM_LIBC_MAIN_DEFAULT_STACK_SIZE</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Count</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>With an eCos kernel, when the cyg_iso_c_start() function is used to
invoke the user-supplied main() function in an ISO C compatible fashion,
a separate thread is created to call main(). This option controls
the size of that thread's stack, which is allocated in the BSS. It
must be a multiple of 8. Note, a low number here may be overriden
by the HAL if there is a minimum requirement to process interrupts
etc.
      </P
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="O-CYGNUM-LIBC-MAIN-THREAD-PRIORITY"
>Option: Priority of main()'s thread</A
></H3
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGNUM_LIBC_MAIN_THREAD_PRIORITY</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Count</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option is used to provide the thread priority which main()'s
thread runs at. Be sure to check that this number is appropriate for
the kernel scheduler chosen. Different kernel schedulers impose different
restrictions on the usable priorities.
      </P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="C-CYGFUN-LIBC-ATEXIT"
>Component: Include atexit() function</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGFUN_LIBC_ATEXIT</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option enables the use of the atexit() function, and ensure that
the atexit handlers are invoked from within exit() as defined in the
ISO C standard.
      </P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="O-CYGNUM-LIBC-ATEXIT-HANDLERS"
>Option: Number of functions atexit() supports</A
></H3
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGNUM_LIBC_ATEXIT_HANDLERS</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Count</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option sets the number of functions that atexit() has room for.
In other words, the number of separate atexit() calls that can be
made before calling exit() or returning from main() ( in an environment
controlled by cyg_iso_c_start() ). For strict compliance with the
ISO C standard this should be at least 32.
      </P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="O-CYGSEM-LIBC-EXIT-CALLS-FFLUSH"
>Option: Make exit() call fflush()</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGSEM_LIBC_EXIT_CALLS_FFLUSH</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option will ensure that all output streams are flushed when exitting
using exit() as prescribed by the ISO C standard.
      </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="O-CYGSEM-LIBC-EXIT-STOPS-SYSTEM"
>Option: _exit() stops all threads</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGSEM_LIBC_EXIT_STOPS_SYSTEM</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>If this option is enabled then _exit(), which is called from exit()
which itself is called on return from main(), stops the eCos scheduler.
For strict POSIX 1003.1 compatibility this would be the normal behaviour.
To allow the thread to simply exit, without affecting other threads,
simply disable this option. If there is no eCos scheduler, then _exit()
simply loops irrespective of the setting of this option.
      </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="C-CYGPKG-LIBC-ENVIRONMENT"
>Component: Provide a system environment</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGPKG_LIBC_ENVIRONMENT</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option allows use of the getenv() function and the global environment
pointer char **environ defined by POSIX 1003.1. Disabling this saves
a small amount of space.
      </P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="O-CYGDAT-LIBC-DEFAULT-ENVIRONMENT"
>Option: Default environment</A
></H3
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGDAT_LIBC_DEFAULT_ENVIRONMENT</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>String</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option allows the setting of the default contents of the environment.
This is in fact the contents of the global environment pointer char
**environ defined by POSIX 1003.1. Strings must be of the form NAME=VALUE,
and the final entry must be NULL.
      </P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="O-CYGSEM-LIBC-INVOKE-DEFAULT-STATIC-CONSTRUCTORS"
>Option: Invoke default static constructors</A
></H2
><H4
CLASS="BRIDGEHEAD"
>Macro name</H4
><P
>CYGSEM_LIBC_INVOKE_DEFAULT_STATIC_CONSTRUCTORS</P
><H4
CLASS="BRIDGEHEAD"
>Type</H4
><P
>Boolean</P
><H4
CLASS="BRIDGEHEAD"
>Description</H4
><P
>This option causes the C library to call static constructors with
default priority from within the context of the main() thread, working
with the co-operation of the HAL. This may be needed for environments
that expect static constructors to be run in a thread context. Note
that this uses an object with priority 65534. Therefore do not use
priority 65534 for any other static objects with this option enabled.
      </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="c-cygpkg-libc-signals.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="ecos-ref.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="c-cygpkg-libc-errno.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Component: Signals</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="p-cygpkg-libc.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Component: errno</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>