<HTML
><HEAD
><TITLE
>Running an eCos test case</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.33"><LINK
REL="HOME"
TITLE="Getting Started with eCos"
HREF="ecos-tutorial.html"><LINK
REL="UP"
TITLE="Programming Tutorial"
HREF="programming-tutorial.html"><LINK
REL="PREVIOUS"
TITLE="Using 
pkgconf.tcl on UNIX"
HREF="using-pkgconf-tcl-on-unix.html"><LINK
REL="NEXT"
TITLE="Building and running sample applications"
HREF="build-and-run-simple-applications.html"></HEAD
><BODY
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Getting Started with <SPAN
CLASS="PRODUCTNAME"
><SPAN
CLASS="TRADEMARK"
>eCos</SPAN
><SUP
><FONT
SIZE="-4"
>TM</FONT
></SUP
></SPAN
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="using-pkgconf-tcl-on-unix.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="build-and-run-simple-applications.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="RUN-AN-ECOS-TEST-CASE"
>Chapter 13. Running an eCos test case</A
></H1
><P
>In <A
HREF="verification.html"
>the section called <I
>Verifying by running on hardware</I
> in Chapter 10</A
> you
ran the prebuilt test case on real hardware; now you are ready to
run one of the test programs in the simulated environment or as
a Linux application.</P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>Note: </B
>If the architecture you use does not have simulator support,
you need to run the following tests on the evaluation boards. Make
sure you have configured and built <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> for
the correct board and for RAM start-up instead of ROM start-up as
described previously. Consult  for details about downloading the
test to the board. Otherwise, the program behavior as described
below should be the same.</P
></BLOCKQUOTE
></DIV
><P
>Start a command window (such as a <B
CLASS="COMMAND"
>bash</B
> shell
or an MS-DOS window) with the environment variables set as described
in the <SPAN
CLASS="PRODUCTNAME"
>GNUPro</SPAN
> documentation. Define the appropriate <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> macro
described in <A
HREF="using-the-simulator.html"
>the section called <I
>Using the simulator</I
> in Chapter 2</A
>. Change to the directory in which
you set up your build tree, and invoke <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> on the test
program. </P
><P
>To run the <B
CLASS="COMMAND"
>bin_sem0</B
> test
(which will test the kernel for the correct creation and destruction
of binary semaphores) type: </P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>$ </TT
><TT
CLASS="USERINPUT"
><B
>gdb <TT
CLASS="OPTION"
>-nw</TT
> install/tests/kernel/bin_sem0</B
></TT
></P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>Note: </B
>If you are using a CD distribution of the <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> Developer&#8217;s
Kit, the <SPAN
CLASS="PRODUCTNAME"
>GNUPro</SPAN
> tool chain which accompanies
it comes with the graphical front end to <SPAN
CLASS="APPLICATION"
>GDB</SPAN
>, <SPAN
CLASS="APPLICATION"
>GDB/Tk</SPAN
>,
which will be invoked unless you specify the 
<TT
CLASS="OPTION"
>-nw</TT
> option to <B
CLASS="COMMAND"
>gdb</B
>. The command
line version of <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> is shown in this
tutorial.</P
></BLOCKQUOTE
></DIV
><P
></P
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 13-1. Starting up <SPAN
CLASS="APPLICATION"
>GDB</SPAN
></B
></P
><P
>You should see the following in the command window:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>GNU gdb THIS-GDB-VERSION
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.  This version of GDB is supported
for customers of Cygnus Solutions.  Type "show warranty" for details.
This GDB was configured as "--host=THIS-HOST --target=THIS-TARGET".
(gdb) </PRE
></TD
></TR
></TABLE
></DIV
><P
>If you are trying to run a synthetic target test on Linux,
skip the simulator connection and download steps. Otherwise, specify
that you are using the simulator target (rather than real hardware)
by typing: </P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>msim</B
></TT
></P
><P
>for the MN10300 AM31, or</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>tsim</B
></TT
></P
><P
>for the TX39, or</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>psim</B
></TT
></P
><P
>for the PowerPC, or</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>ssim</B
></TT
></P
><P
>for the SPARClite.</P
><P
></P
><P
>You will see the following lines on your screen: </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>Connected to the simulator.
(gdb) </PRE
></TD
></TR
></TABLE
><P
>Now download the program to the (simulator) target with</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>load</B
></TT
></P
><P
>You should see output similar to the following on your screen: </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>Loading section .rom_vectors, size 0xc0 lma 0x40000000
Loading section .text, size 0x1b3b lma 0x400000c0
Loading section .rodata, size 0x2f4 lma 0x40001bfc
Loading section .data, size 0x7c lma 0x40001ef0
Start address 0x40000000
Transfer rate: 64344 bits in &#60;1 sec.
(gdb)</PRE
></TD
></TR
></TABLE
><P
>You are now ready to run your program as if this were an ordinary
debugging session with <SPAN
CLASS="APPLICATION"
>GDB</SPAN
>. If you type </P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>run</B
></TT
></P
><P
>you will see output similar to the following: </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>Starting program: /ecos-work/./install/tests/kernel/bin_sem0.exe
PASS:&#60;Binary Semaphore 0 OK&#62;
EXIT:&#60;done&#62; </PRE
></TD
></TR
></TABLE
><P
>You must kill your <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> session
with <B
CLASS="KEYCAP"
>Control</B
>-<B
CLASS="KEYCAP"
>C</B
>,
or it will sit in the &#8220;idle&#8221; thread and use up
CPU time. Type <B
CLASS="COMMAND"
>quit</B
> and you are done. </P
><P
>See &#8220;Verifying by running on hardware&#8221;.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="using-pkgconf-tcl-on-unix.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="ecos-tutorial.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="build-and-run-simple-applications.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Using 
<B
CLASS="COMMAND"
>pkgconf.tcl</B
> on UNIX</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="programming-tutorial.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Building and running sample applications</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>