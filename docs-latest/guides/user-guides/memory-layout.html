<HTML
><HEAD
><TITLE
>Memory layout</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.33"><LINK
REL="HOME"
TITLE="eCos Users
Guide"
HREF="user-guides.html"><LINK
REL="UP"
TITLE="Configuration Tool Views"
HREF="the-four-panes.html"><LINK
REL="PREVIOUS"
TITLE="Output Pane"
HREF="output-pane.html"><LINK
REL="NEXT"
TITLE="Basic Operations"
HREF="basic-operations.html"></HEAD
><BODY
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
><SPAN
CLASS="TRADEMARK"
>eCos</SPAN
><SUP
><FONT
SIZE="-4"
>TM</FONT
></SUP
> User&#8217;s
Guide</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="output-pane.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 2. Configuration Tool Views</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="basic-operations.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="MEMORY-LAYOUT"
>Memory layout</A
></H1
><P
>The memory
layout window presents a graphical view of the memory layout for
the currently selected combination of target architecture, platform,
and start-up type. Each memory region is represented by a horizontal
bar within the window. Each bar is divided into a number of blocks
representing memory sections. Unused parts of a memory region are
represented using hatching. All numeric information is presented in
hexadecimal format:</P
><P
><IMG
SRC="../mlt-view.gif"
ALIGN="CENTER"></P
><P
>Default memory layouts are provided for all supported platforms
and it is not necessary to edit these layouts in order to start
development with <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
>. However, it may
be necessary to modify the memory layouts when, for example, additional memory
is installed on an evaluation board. When the memory layout is modified,
a new linker script fragment is generated and the linker is therefore
able to make use of the new memory.</P
><P
>In addition to the linker-defined output sections, the memory
layout window allows the user to specify memory sections which are
to be reserved for use by a specific <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> application.
The <SPAN
CLASS="APPLICATION"
>Configuration Tool</SPAN
> will ensure that
such user-defined memory sections are not used by <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> itself.</P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="MANIPULATION"
>Layout manipulation</A
></H2
><P
>The memory layout window includes controls to create, delete
and modify the properties of both memory regions and memory sections
(collectively referred to as <I
CLASS="FIRSTTERM"
>memory
items</I
>). These manipulation
functions are accessible from both the system menu and the toolbar.
When modifying or deleting an item, it is necessary to first select
it using a pointing device. The currently selected item is displayed
with a focus rectangle (as section <I
CLASS="EMPHASIS"
>rodata</I
> above).
Creation and modification of a memory item is achieved using a 
<I
CLASS="FIRSTTERM"
>property sheet</I
>. The property
sheet for a memory item may also be accessed by double-clicking
on the item in the memory window.</P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="MEMORY-REGIONS"
>Memory regions</A
></H3
><P
>Details of a memory
region may be specified or modified using the <I
CLASS="EMPHASIS"
>region
properties</I
> sheet. The general settings page of this sheet
allows editing of the region parameters:</P
><P
><IMG
SRC="../mlt-region-general.gif"
ALIGN="CENTER"></P
><P
>The name of each memory region is arbitrary but should not
contain spaces or punctuation characters. The start address and
size of each memory region should be specified in bytes and entered
as hexadecimal numbers. The read only check box should be checked
where the memory region represents a block of read-only memory. This
information is used to verify that the initial and final locations
of any relocating memory sections are within appropriate memory
regions.</P
><P
>The note page of the region properties sheet may be used to
keep notes concerning the memory region. These notes are saved with
the memory layout in the build tree.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="MEMORY-SECTIONS"
>Memory sections</A
></H3
><P
>Details of a memory
section may be specified or modified using the <I
CLASS="EMPHASIS"
>section
properties</I
> sheet. The general settings page of this sheet
allows editing of the parameters which are common to all sections:</P
><P
><IMG
SRC="../mlt-section-general.gif"
ALIGN="CENTER"></P
><P
>Each memory section is either linker-defined or user-defined.
The name of a linker-defined section is selected from a drop-down
list appropriate for the currently selected target architecture.
Only those names which are not currently in use are presented. The
name of a user-defined section is entered from the keyboard and should
not contain spaces or punctuation characters. The size of a user-defined
section may also be specified by checking the known size check box.
The size should then be entered as a hexadecimal number. User-defined
sections of unknown size are assumed to occupy all available space
up to next section or the end of the memory region.</P
><P
>The final location (VMA) of a memory section may be defined
using an absolute start address or by specifying another section
which it follows in the memory map. Where an absolute address is
required, this should be entered as a hexadecimal number. Alternatively,
the preceding section may selected from a drop-down list of appropriate existing
sections. In this case, the alignment of the section in terms of
an n-byte boundary should also be selected.</P
><P
>The relocation settings page allows editing of the parameters
which are specific to relocating sections:</P
><P
><IMG
SRC="../mlt-section-relocation.gif"
ALIGN="CENTER"></P
><P
>The relocation of a memory section at system start-up is enabled
by checking the relocate section check box. The initial location
(LMA) of a memory section may be defined using an absolute start
address or by specifying another section which it follows in the
memory map. Where an absolute address is required, this should be entered
as a hexadecimal number. The address must lie within a read-only
memory region. Alternatively, the preceding section may selected
from a drop-down list of appropriate existing sections. The initial
location of the preceding section must be located in a read-only
memory region.</P
><P
>The note page of the section properties sheet may be used
to keep notes concerning the memory section. These notes are saved
with the memory layout in the build tree.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="MEMORY-ACCESS"
>Memory access</A
></H2
><P
>User-defined memory sections may be accessed
using C pre-processor macros defined in a memory layout header file
exported by the <SPAN
CLASS="APPLICATION"
>Configuration Tool</SPAN
>. The
name of the memory layout header file appropriate for the current
configuration is defined by the <TT
CLASS="FILENAME"
>CYGHWR_MEMORY_LAYOUT_H</TT
> macro
in the <TT
CLASS="FILENAME"
>pkgconf/system.h</TT
> header file.</P
><P
>Macros specifying the start address and size are defined for
each user-defined memory section and may be accessed as follows:</P
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 2-1. Accessing a
user-defined memory section named <I
CLASS="EMPHASIS"
>example</I
></B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>#include &#60;pkgconf/system.h&#62;
#include CYGHWR_MEMORY_LAYOUT_H

int main ()
{
 // use the memory section as an integer array
 int * array = (int *) CYGMEM_SECTION_example;
 unsigned int array_size = CYGMEM_SECTION_example_SIZE / sizeof (int);

 // initialize each array element
 unsigned int count;
 for (count = 0; count &#60; array_size; ++count)
 array [count] = 0;

 return 0;
}</PRE
></TD
></TR
></TABLE
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="output-pane.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="user-guides.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="basic-operations.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Output Pane</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="the-four-panes.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Basic Operations</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>