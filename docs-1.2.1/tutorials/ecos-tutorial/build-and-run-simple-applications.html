<HTML
><HEAD
><TITLE
>Building and running sample applications</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.33"><LINK
REL="HOME"
TITLE="Getting Started with eCos"
HREF="ecos-tutorial.html"><LINK
REL="UP"
TITLE="Programming Tutorial"
HREF="programming-tutorial.html"><LINK
REL="PREVIOUS"
TITLE="Running an eCos test case"
HREF="run-an-ecos-test-case.html"><LINK
REL="NEXT"
TITLE="A sample
program with two threads"
HREF="a-simple-program-with-two-threads.html"></HEAD
><BODY
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Getting Started with <SPAN
CLASS="PRODUCTNAME"
><SPAN
CLASS="TRADEMARK"
>eCos</SPAN
><SUP
><FONT
SIZE="-4"
>TM</FONT
></SUP
></SPAN
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="run-an-ecos-test-case.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="a-simple-program-with-two-threads.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="BUILD-AND-RUN-SIMPLE-APPLICATIONS"
>Chapter 14. Building and running sample applications</A
></H1
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
><A
HREF="build-and-run-simple-applications.html#ECOS-HELLO-WORLD"
>eCos hello world</A
></DT
><DT
><A
HREF="a-simple-program-with-two-threads.html"
>A sample
program with two threads</A
></DT
></DL
></DIV
><P
>The example programs in this tutorial are included, along
with a <TT
CLASS="FILENAME"
>Makefile</TT
>, in the <TT
CLASS="FILENAME"
>examples</TT
> directory
of the <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> distribution. The first program
you will run is a <I
CLASS="EMPHASIS"
>hello world</I
>-style application,
then you will run a more complex application that demonstrates the
creation of threads and the use of <TT
CLASS="FUNCTION"
><B
>cyg_thread_delay()</B
></TT
>,
and finally you will run one that uses clocks and alarm handlers.</P
><P
>	The <TT
CLASS="FILENAME"
>Makefile</TT
> has two variables you will
	need to adjust: <TT
CLASS="REPLACEABLE"
><I
>PKG_INSTALL_DIR</I
></TT
> and
	<TT
CLASS="REPLACEABLE"
><I
>XCC</I
></TT
>. Edit the
	<TT
CLASS="FILENAME"
>Makefile</TT
>, setting
	<TT
CLASS="REPLACEABLE"
><I
>PKG_INSTALL_DIR</I
></TT
> to the install tree
	previously created by <B
CLASS="COMMAND"
>pkgconf.tcl</B
> and
	uncommenting the relevant <TT
CLASS="REPLACEABLE"
><I
>XCC</I
></TT
> line
	for your architecture.
      </P
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="ECOS-HELLO-WORLD"
>eCos hello world</A
></H1
><P
>The following code is found in the file <TT
CLASS="FILENAME"
>hello.c</TT
> in
the <TT
CLASS="FILENAME"
>examples</TT
> directory: </P
><P
></P
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 14-1. eCos hello world program listing</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>/* this is a simple hello world program */
#include &#60;stdio.h&#62;

int main(void)
{
 printf("Hello, eCos world!\n");
 return 0;
} </PRE
></TD
></TR
></TABLE
></DIV
><P
>To compile this or any other program that is not part of the <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> distribution,
you can type this explicit compilation instruction (assuming your
current working directory is also where you built the <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> kernel):</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>$ </TT
><TT
CLASS="USERINPUT"
><B
>gcc -g -I<TT
CLASS="REPLACEABLE"
><I
>BASE_DIR</I
></TT
>/ecos-work/install/include hello.c -L<TT
CLASS="REPLACEABLE"
><I
>BASE_DIR</I
></TT
>/ecos-work/install/lib -Ttarget.ld -nostdlib</B
></TT
></P
><P
>The compilation instruction above contains some standard <SPAN
CLASS="APPLICATION"
>GCC</SPAN
> options
(for example, <TT
CLASS="OPTION"
>-g</TT
> enables debugging), as well as
some mention of paths (<TT
CLASS="OPTION"
>-I<TT
CLASS="REPLACEABLE"
><I
>BASE_DIR</I
></TT
>/ecos-work/install/include</TT
> allows
files like <TT
CLASS="FILENAME"
>cyg/kernel/kapi.h</TT
> to be
found, and <TT
CLASS="OPTION"
>-L<TT
CLASS="REPLACEABLE"
><I
>BASE_DIR</I
></TT
>/ecos-work/install/lib</TT
> allows
the linker to find <TT
CLASS="OPTION"
>-Ttarget.ld</TT
>). </P
><P
>The executable program will be called <TT
CLASS="FILENAME"
>a.out</TT
>. </P
><P
>You can now run the resulting program in the simulator using <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> the
way you ran the test case. The sequence of steps will be the same
(skip steps 2 and 3 if using the synthetic Linux target):</P
><DIV
CLASS="PROCEDURE"
><OL
TYPE="1"
><LI
><P
>Run <B
CLASS="COMMAND"
>gdb</B
> specifying <TT
CLASS="OPTION"
>-nw
a.out</TT
> on the command line:</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>$ </TT
><TT
CLASS="USERINPUT"
><B
>gdb -nw a.out</B
></TT
></P
></LI
><LI
><P
>Type <B
CLASS="COMMAND"
>msim</B
> on the MN10300, <B
CLASS="COMMAND"
>tsim</B
> on
the TX39, <B
CLASS="COMMAND"
>psim</B
> on the PowerPC, or <B
CLASS="COMMAND"
>ssim</B
> on
the SPARClite.</P
></LI
><LI
><P
>Type <B
CLASS="COMMAND"
>load</B
></P
></LI
></OL
></DIV
><P
>At this point you are ready to run the usual <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> commands.
For example, you can simply type <B
CLASS="COMMAND"
>run</B
> at the <TT
CLASS="PROMPT"
>(gdb)</TT
> prompt
and the program will execute and print the string <TT
CLASS="COMPUTEROUTPUT"
>Hello,
eCos world!</TT
> on your screen.</P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="run-an-ecos-test-case.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="ecos-tutorial.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="a-simple-program-with-two-threads.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Running an eCos test case</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="programming-tutorial.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>A sample
program with two threads</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>