<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML
><HEAD
><TITLE
>Run an eCos test case</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet version 1.19"><LINK
REL="HOME"
TITLE="Getting Started with eCosTM"
HREF="ecos-tutorial.html"><LINK
REL="UP"
TITLE="Programming Tutorial"
HREF="programming-tutorial.html"><LINK
REL="PREVIOUS"
TITLE="Using pkgconf.tcl on UNIX"
HREF="using-pkgconf-tcl-on-unix.html"><LINK
REL="NEXT"
TITLE="Build and run simple applications"
HREF="build-and-run-simple-applications.html"></HEAD
><BODY
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Getting Started with <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
><SUP
><FONT
SIZE="-1"
>TM</FONT
></SUP
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="using-pkgconf-tcl-on-unix.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="build-and-run-simple-applications.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="RUN-AN-ECOS-TEST-CASE"
>Chapter 15. Run an eCos test case</A
></H1
><P
>	In <A
HREF="verification.html"
>the section called <I
>Verification</I
> in Chapter 12</A
> you ran the prebuilt test
	case  on real hardware; now you are ready to run one of the
	test  programs in the simulated environment.</P
><P
>	Start a command window, for example a <B
CLASS="COMMAND"
>bash</B
>
	shell or an MS-DOS command prompt with the environment
	variables set up as described in the <SPAN
CLASS="PRODUCTNAME"
>GNUPro</SPAN
> documentation.
	Change to the directory in which you set up your build tree,
	and invoke <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> on the test program.
	To run the <B
CLASS="COMMAND"
>bin_sem0</B
> test (which will test
	the kernel for the correct creation and destruction of binary
	semaphores) type:
      </P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>$ </TT
><TT
CLASS="USERINPUT"
><B
>gdb <TT
CLASS="OPTION"
>-nw</TT
> install/tests/kernel/bin_sem0</B
></TT
></P
><P
>You should see the following in the command window:</P
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 15-1. Starting up <SPAN
CLASS="APPLICATION"
>GDB</SPAN
></B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13;GNU gdb 4.17-ecos-98r1p3
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.  This version of GDB is supported
for customers of Cygnus Solutions.  Type "show warranty" for details.
This GDB was configured as "--host=THIS-HOST --target=THIS-TARGET".
(gdb) </PRE
></TD
></TR
></TABLE
></DIV
><P
>To specify that you are using the simulator target (rather
	than real hardware) you can type:
      </P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>target sim --board=stdeval1</B
></TT
></P
><P
>on the MN10300, or</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>target sim --board=jmr3904</B
></TT
></P
><P
>on the TX39, or</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>target sim -f <TT
CLASS="REPLACEABLE"
><I
>BASE_DIR</I
></TT
>/hal/powerpc/sim/v1_1/runtime/tree</B
></TT
></P
><P
>on the PowerPC.</P
><P
>	You will see the following lines on your screen:
      </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13;Connected to the simulator.
(gdb) </PRE
></TD
></TR
></TABLE
><BLOCKQUOTE
CLASS="TIP"
><P
><B
>Tip: </B
>	  The PowerPC instruction for <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> 
	  involves typing a lengthy line to set up some parameters for 
	  the simulator.  One way
	  to reduce the amount of typing is to put the following code
	  in your personal <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> startup file
	  (<TT
CLASS="FILENAME"
>gdb.init</TT
> on Windows and
	  <TT
CLASS="FILENAME"
>.gdbinit</TT
> on UNIX):</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>&#13;define psim
target sim -f <TT
CLASS="REPLACEABLE"
><I
>BASE_DIR</I
></TT
>/hal/powerpc/sim/v1_1/runtime/tree
load
break cyg_test_exit
break cyg_assert_fail
end</PRE
></TD
></TR
></TABLE
></BLOCKQUOTE
><P
>	Now download the program to the (simulator) target with</P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>load</B
></TT
></P
><P
>	You should see the following output on your screen:
      </P
><P
></P
><UL
><LI
><P
>On the MN10300:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>	  
Loading section .rom_vectors, size 0xc0 lma 0x40000000
Loading section .text, size 0x1b3b lma 0x400000c0
Loading section .rodata, size 0x2f4 lma 0x40001bfc
Loading section .data, size 0x7c lma 0x40001ef0
Start address 0x40000000
Transfer rate: 64344 bits in &#60;1 sec.
(gdb)</PRE
></TD
></TR
></TABLE
></LI
><LI
><P
>On the TX39:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13;Loading section .rom_vectors, size 0x218 lma 0xbfc00000
Loading section .text, size 0x56a8 lma 0xbfc00218
Loading section .rodata, size 0x41c lma 0xbfc058c0
Loading section .data, size 0x578 lma 0xbfc05ce0
Start address 0xbfc00000
Transfer rate: 201376 bits in &#60;1 sec.
(gdb) </PRE
></TD
></TR
></TABLE
></LI
><LI
><P
>On the PowerPC:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>Loading section .rom_vectors, size 0xa8 vma 0x40000000
Loading section .text, size 0x19ef vma 0x400000a8
Loading section .rodata, size 0x318 vma 0x40001a98
Loading section .data, size 0x68 vma 0x40001db0
Start address 0x40000000
Transfer rate: 61624 bits in &#60;1 sec.
(gdb)</PRE
></TD
></TR
></TABLE
></LI
></UL
><P
>You are now ready to run your program as if this were an
	ordinary debugging session with
	<SPAN
CLASS="APPLICATION"
>GDB</SPAN
>.  If you type
      </P
><P
CLASS="LITERALLAYOUT"
><TT
CLASS="PROMPT"
>(gdb) </TT
><TT
CLASS="USERINPUT"
><B
>run</B
></TT
></P
><P
>	you will see the something like following output:
      </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13;Starting program: /ecos-work/./install/tests/kernel/bin_sem0.exe
PASS:&#60;Binary Semaphore 0 OK&#62;
EXIT:&#60;done&#62; </PRE
></TD
></TR
></TABLE
><P
>	You must kill your <SPAN
CLASS="APPLICATION"
>GDB</SPAN
> session
	with
	<B
CLASS="KEYCAP"
>Control</B
>-<B
CLASS="KEYCAP"
>C</B
>, or it will sit in the "idle" thread
	and use up CPU time.  Type <B
CLASS="COMMAND"
>quit</B
> and you are done.
      </P
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>Note: </B
>	  If you are using a CD distribution of the <SPAN
CLASS="PRODUCTNAME"
>eCos</SPAN
> Developer's
	  Kit, the <SPAN
CLASS="PRODUCTNAME"
>GNUPro</SPAN
> tool chain which accompanies it comes with
	  the graphical front end to <SPAN
CLASS="APPLICATION"
>GDB</SPAN
>,
	  <SPAN
CLASS="APPLICATION"
>GDB/Tk</SPAN
>, which will be invoked if
	  you do not specify the <TT
CLASS="OPTION"
>-nw</TT
> option to
	  <B
CLASS="COMMAND"
>gdb</B
>.  We have used the command line
	  version in this tutorial.
	</P
></BLOCKQUOTE
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="using-pkgconf-tcl-on-unix.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="ecos-tutorial.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="build-and-run-simple-applications.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Using <B
CLASS="COMMAND"
>pkgconf.tcl</B
> on UNIX</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="programming-tutorial.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Build and run simple applications</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>