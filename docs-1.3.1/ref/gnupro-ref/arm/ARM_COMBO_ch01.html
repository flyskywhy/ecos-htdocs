<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.51 [en] (WinNT; U) [Netscape]">
   <title>Reference</title>
</head>
<body bgcolor="#FFFFFF">

<h1 CLASS="ChapterTitle">
<a NAME="pgfId-464545"></a>Reference
<hr WIDTH="100%"></h1>
&nbsp;
<p>&nbsp;

<p CLASS="BodyAfterHead"><a NAME="pgfId-464546"></a>The Reference section
describes the ARM ABI and ARM-specific attributes of the main GNUPro tools.
<ul>
<li CLASS="Bullet">
<a NAME="pgfId-461757"></a>Compiler</li>

<li CLASS="Bullet">
<a NAME="pgfId-461763"></a>ABI Summary for ARM and Thumb</li>

<li CLASS="Bullet">
<a NAME="pgfId-461764"></a>Assembler</li>

<li CLASS="Bullet">
<a NAME="pgfId-461765"></a>Linker</li>

<li CLASS="Bullet">
<a NAME="pgfId-461766"></a>Debugger</li>
</ul>

<h2 CLASS="Heading1">
<a NAME="pgfId-461235"></a><a NAME="_Toc442250435"></a>Compiler
<hr WIDTH="100%"></h2>

<p CLASS="Body"><a NAME="pgfId-461236"></a>This section describes features
of the GNUPro ARM and Thumb compilers.</p>


<p CLASS="Body"><a NAME="pgfId-937439"></a>By default the ARM compiler
supplied with eCos will produce code optimized for the ARM7m processor.
This code will run on other, higher, ARM processors including the StrongARM,
but to get the best possible performance the target cpu should be specified
on the compiler command line using the '<tt>-mcpu=</tt>' switch documented
below.
<h3 CLASS="Heading2">
<a NAME="pgfId-913244"></a>Command-line options
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-938118"></a>For a list of available generic
compiler options, refer to "GNU CC Command Options" in <b><i>Using GNU
CC in GNUPro Compiler Tools</i></b> . In addition, the following '<tt>arm-elf-gcc</tt>'
and '<tt>thumb-elf-gcc</tt>' specific command-line options are supported:</p>

<h4 CLASS="Heading3">
<a NAME="pgfId-938119"></a>arm-elf-gcc options
<hr WIDTH="100%"></h4>

<blockquote><a NAME="pgfId-928099"></a><tt>-mabort-on-noreturn</tt>
<blockquote>This switch tells the compiler to insert a call to the library
function '<tt>abort</tt>' at the end of any function which has the '<tt>noreturn</tt>'
attribute.This is disabled by default because some eCos configurations
may not have the abort library call present.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930764"></a><tt>-mapcs-frame</tt></p>

<blockquote>Generate a stack frame upon entry to a function, as defined
in the ARM Procedure Calling Standard.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930766"></a><tt>-mno-apcs-frame</tt></p>

<blockquote>Do not generate a stack frame upon entry to a function. The
APCS specifies that stack frames are optional, and omitting them produces
lightly smaller and faster code. However, debugging with stack frames omitted
can be more difficult. This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930768"></a><tt>-mapcs-32</tt></p>

<blockquote>Produce assembly code that conforms to the 32-bit version of
the ARM Procedure Calling Standard. This is the default setting.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930770"></a><tt>-mapcs-26</tt></p>

<blockquote>Produce assembly code that conforms to the 26-bit version of
the ARM Procedure Calling Standard, as used by earlier versions of the
ARM processor (ARM2, ARM3).

<p CLASS="BodyListFollow"><a NAME="pgfId-930772"></a><b><i>This option
is not supported for use with eCos.</i></b></blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930773"></a><tt>-mapcs-stack-check</tt></p>

<blockquote>Produce assembly code which checks the amount of stack space
available upon entry to a function and which calls a suitable function
if their is insufficient space available.

<p CLASS="BodyListFollow"><a NAME="pgfId-930775"></a><b><i>This option
is not supported for use with eCos.</i></b></blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930776"></a><tt>-mno-apcs-stack-check</tt></p>

<blockquote>Do not produce code to check for stack space upon entry to
a function. This is the default setting.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930778"></a><tt>-mapcs-reentrant</tt></p>

<blockquote>Produce assembly code that is position independent and reentrant.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930780"></a><tt>-mno-apcs-rentrant</tt></p>

<blockquote>Do not produce position independent, reentrant assembly code.
This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930782"></a><tt>-mshort-load-bytes</tt></p>

<blockquote>Two byte values should be loaded by performing two individual
byte loads and then merging the results. This allows shorts to be loaded
from non-aligned addresses without generating a memory access fault.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930785"></a><tt>-mno-short-load-bytes</tt></p>

<blockquote>Two byte values should be loaded using the most space efficient
method. On an ARM processor that supports half word loads these instructions
will be used. This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930787"></a><tt>-mfpe</tt></p>

<blockquote>Floating point instructions should be emulated by the ARM Floating
Point Emulator code, which is supplied by the operating system.

<p CLASS="BodyListFollow"><a NAME="pgfId-938715"></a><b><i>This option
is not supported for use with eCos.</i></b></blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930789"></a><tt>-mfpe=N</tt></p>

<blockquote>Floating point instructions should be emulated by the ARM Floating
Point Emulator code version '<tt>N</tt>'. Valid version numbers are 2 and
3. 2 is the default setting.

<p CLASS="BodyListFollow"><a NAME="pgfId-938720"></a><b><i>This option
is not supported for use with eCos.</i></b></blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930791"></a><tt>-msoft-float</tt></p>

<blockquote>Floating point instructions should be emulated by library calls.
This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930793"></a><tt>-mhard-float</tt></p>

<blockquote>Floating point instructions can be performed in hardware.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930795"></a><tt>-mbig-endian</tt></p>

<blockquote>Produce assembly code which is targeted for a big endian processor.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930797"></a><tt>-mlittle-endian</tt></p>

<blockquote>Produce assembly code which is targeted for a little endian
processor. This is the default setting.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-930799"></a><tt>-mwords-little-endian</tt></p>

<blockquote>Produce assembly code which is targeted for a big endian processor,
but which stores words in a little endian format. This is for backward
compatibility with older versions of GCC.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930801"></a><tt>-mthumb-interwork</tt></p>

<blockquote>Produce assembly code which supports calls between the ARM
instruction set and the Thumb instruction set.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930803"></a><tt>-mno-thumb-interwork</tt></p>

<blockquote>Do not produce code specifically intended to support calling
between ARM and Thumb instruction sets. This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930806"></a><tt>-msched-prolog</tt></p>

<blockquote>Allow instructions in function prologues to be rearranged to
improve performance. This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-930808"></a><tt>-mno-sched-prolog</tt></p>

<blockquote>Do not allow the instructions in function prologues to be rearranged.
This guarantees that function prologues will have a well-defined form,
depending upon their nature.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-936508"></a><tt>-mcpu=XXXX</tt></p>

<blockquote>Produce assembly code specifically for the indicated processor.
The variable '<tt>XXXX</tt>' can be one of the following processors.</blockquote>
</blockquote>

<center><table COLS=4 WIDTH="640" >
<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937086"></a><tt>arm2</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937088"></a><tt>arm250</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937090"></a><tt>arm3</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937092"></a><tt>arm6</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937094"></a><tt>arm60</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937967"></a><tt>arm600</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937969"></a><tt>arm610</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937971"></a><tt>arm620</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937102"></a><tt>arm7</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937953"></a><tt>arm7m</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937955"></a><tt>arm7d</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937957"></a><tt>arm7dm</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937110"></a><tt>arm7di</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937939"></a><tt>arm7dmi</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937941"></a><tt>arm70</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937943"></a><tt>arm700</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937118"></a><tt>arm700i</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937924"></a><tt>arm710</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937926"></a><tt>arm710c</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937928"></a><tt>arm7100</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937915"></a><tt>arm7500</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937907"></a><tt>arm7500fe</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937909"></a><tt>arm7tdmi</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937911"></a><tt>arm8</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937134"></a><tt>arm810</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937892"></a><tt>arm9</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937894"></a><tt>arm920</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937896"></a><tt>arm920t</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-937883"></a><tt>arm9tdmi</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937877"></a><tt>strongarm</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937879"></a><tt>strongarm110</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-937881"></a><tt>strongarm1100</tt></p>
</td>
</tr>
</table></center>

<blockquote>
<blockquote>
<p CLASS="BodyListFollow"><a NAME="pgfId-937225"></a><b><font size=+1>Note:</font></b>
If '<tt>-mcpu</tt>' is not specified, the default is to generate code for
the '<tt>arm7m</tt>'<tt> .</tt></p>
</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-937221"></a><tt>-march=XXXX</tt></p>

<blockquote>Produce assembly code specifically for an ARM processor of
the indicated architecture. The variable '<tt>XXXX</tt>' can be one of
the following architectures.
<br><a NAME="pgfId-937246"></a><tt>armv2</tt>
<br><a NAME="pgfId-937248"></a><tt>armv2a</tt>
<br><a NAME="pgfId-937250"></a><tt>armv3</tt>
<br><a NAME="pgfId-937252"></a><tt>armv3m</tt>
<br><a NAME="pgfId-937254"></a><tt>armv4</tt>
<br><a NAME="pgfId-937256"></a><tt>armv4t</tt></blockquote>
</blockquote>

<blockquote>
<blockquote>
<p CLASS="BodyListFollow"><a NAME="pgfId-937433"></a><b><font size=+1>Note:
</font></b>If
'<tt>-march</tt>' is not specified, the default is to generate code for
the '<tt>armv4</tt>'<tt> .</tt></p>
</blockquote>
</blockquote>

<h4 CLASS="Heading3">
<a NAME="pgfId-938125"></a>thumb-elf-gcc options
<hr WIDTH="100%"></h4>

<blockquote><a NAME="pgfId-938129"></a><tt>-mtpcs-frame</tt></blockquote>

<blockquote>
<blockquote>Generate a stack frame upon entry to a non-leaf function, as
defined in the Thumb Procedure Calling Standard. A leaf function is a function
that does not call any other function.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938131"></a><tt>-mno-tpcs-frame</tt></p>

<blockquote>Do not generate a stack frame upon entry to a non-leaf function.
The TPCS specifies that the generation of stack frames is optional, hence
this pair of options. This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938133"></a><tt>-mtpcs-leaf-frame</tt></p>

<blockquote>Generate a stack frame upon entry to a leaf function, as defined
in the Thumb Procedure Calling Standard.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938135"></a><tt>-mno-tpcs-leaf-frame</tt></p>

<blockquote>Do not generate a stack frame upon entry to a leaf function.
This is the default setting.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-938137"></a><tt>-mbig-endian</tt></p>

<blockquote>Produce assembly code which is targeted for a big endian processor.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938139"></a><tt>-mlittle-endian</tt></p>

<blockquote>Produce assembly code which is targeted for a little endian
processor. This is the default setting.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938141"></a><tt>-mthumb-interwork</tt></p>

<blockquote>Produce assembly code which supports calls between the ARM
instruction set and the Thumb instruction set.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938143"></a><tt>-mno-thumb-interwork</tt></p>

<blockquote>Do not produce code specifically intended to support calling
between ARM and Thumb instruction sets. If such calls are used, they will
probably fail. This is the default setting.</blockquote>
</blockquote>

<h3 CLASS="Heading2">
<a NAME="pgfId-938388"></a><a NAME="_Toc442250437"></a>Preprocessor symbols
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-938389"></a>The following '<tt>arm-elf-gcc</tt>'
and '<tt>thumb-elf-gcc</tt>' specific preprocessor symbols are supported:</p>

<h4 CLASS="Heading3">
<a NAME="pgfId-938363"></a>arm-elf-gcc</h4>

<p CLASS="Body"><a NAME="pgfId-934794"></a></p>

<br>&nbsp;
<table BORDER >
<tr>
<th>
<p CLASS="CellHeading"><a NAME="pgfId-939136"></a>Symbol</p>
</th>

<th>
<p CLASS="CellHeading"><a NAME="pgfId-939138"></a>Condition</p>
</th>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939140"></a><tt>arm</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939142"></a>Is always defined.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939144"></a><tt>__semi__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939146"></a>Is always defined.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939148"></a><tt>__APCS_32__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939150"></a>If '<tt>-mapcs-26</tt>'
has NOT been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939152"></a><tt>__APCS_26__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939154"></a>If '<tt>-mapcs-26</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939156"></a><tt>__SOFTFP__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939158"></a>If '<tt>-mhard-float</tt>'
has NOT been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939160"></a><tt>__ARMWEL__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939162"></a>If '<tt>-mwords-little-endian</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939164"></a><tt>__ARMEB__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939166"></a>If '<tt>-mbig-endian</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939172"></a><tt>__ARM_ARCH_2__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939174"></a>If '<tt>-mcpu=arm2</tt>'
or '<tt>-mcpu=arm205</tt>' or '<tt>-mcpu=arm3</tt>' or '<tt>-march=armv2</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939176"></a><tt>__ARM_ARCH_3__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939178"></a>If '<tt>-mcpu=arm6</tt>'
or '<tt>-mcpu=arm600</tt>' or '<tt>-mcpu=arm610</tt>' or '<tt>-mcpu=arm7</tt>'
or '<tt>-mcpu=arm700</tt>' or '<tt>-mcpu=arm710</tt>' or '<tt>-mcpu=arm710c</tt>'
or '<tt>-mcpu=arm7100</tt>' or '<tt>-mcpu=arm7500</tt>' or '<tt>-mcpu=arm7500fe</tt>'
or '<tt>-march=armv3</tt>' has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939180"></a><tt>__ARM_ARCH_3M__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939182"></a>If '<tt>-mcpu=arm7m</tt>'
or '<tt>-mcpu=arm7dm</tt>' or '<tt>-mcpu=arm7dmi</tt>' or '<tt>-march=armv3m</tt>'
or neither '<tt>-mcpu=xxxx</tt>' nor '<tt>-march=xxxx</tt>' has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939184"></a><tt>__ARM_ARCH_4__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939186"></a>If '<tt>-mcpu=arm8</tt>'
or '<tt>-mcpu=arm810</tt>' or '<tt>-mcpu=arm920</tt>' or '<tt>-mcpu=strongarm</tt>'
or '<tt>-mcpu=strongarm110</tt>' or '<tt>-mcpu=strongarm1100</tt>' or '<tt>-march=armv4</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939188"></a><tt>__ARM_ARCH_4T__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939190"></a>If '<tt>-mcpu=arm7tdmi</tt>'
or '<tt>-mcpu=arm9</tt>' or '<tt>-mcpu=arm920t</tt>' or '<tt>-mcpu=arm9tdmi</tt>'
or '<tt>-march=armv4t</tt>' has been specified.</p>
</td>
</tr>
</table>

<h4 CLASS="Heading2">
<a NAME="pgfId-930458"></a>thumb-elf-gcc</h4>

<table BORDER >
<tr>
<th>
<p CLASS="CellHeading"><a NAME="pgfId-938415"></a>Symbol</p>
</th>

<th>
<p CLASS="CellHeading"><a NAME="pgfId-938417"></a>Condition</p>
</th>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938419"></a><tt>thumb</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938421"></a>Is always defined.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938423"></a><tt>__thumb</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938425"></a>Is always defined.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938607"></a><tt>thumb</tt> elf</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938609"></a>Is always defined.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938427"></a><tt>__ARMEB__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938429"></a>If '<tt>-mbig-endian</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938431"></a><tt>__ARMEL__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938433"></a>If '<tt>-mbig-endian</tt>'
has NOT been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938435"></a><tt>__THUMBEB__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938437"></a>If '<tt>-mbig-endian</tt>'
has been specified.</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-938439"></a><tt>__THUMBEL__</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938441"></a>If '<tt>-mbig-endian</tt>'
has NOT been specified.</p>
</td>
</tr>
</table>

<h3 CLASS="Heading2">
<a NAME="pgfId-938392"></a>Attributes
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-934879"></a>For a compete description
of attributes, see "Declaring Attributes of Functions" and "Specifying
Attributes of Variables" in "Extensions to the C Language Family" in Using
GNU CC in <b><i>GNUPro Compiler Tools</i></b>. There is one ARM-specific
attribute:</p>

<blockquote><a NAME="pgfId-934880"></a><tt>naked</tt></blockquote>

<blockquote>
<blockquote>This is a function attribute. GCC will not generate any prologue
or epilogue code for any function with this attribute. It is up to the
programmer to provide any necessary prologue and epilogue code themselves
(possibly via asm() statements).</blockquote>
</blockquote>

<h2 CLASS="Heading1">
<a NAME="pgfId-916527"></a>New compiler and linker features
<hr WIDTH="100%"></h2>

<p CLASS="Body"><a NAME="pgfId-916529"></a>The GNUPro compiler and linker
have been improved by Cygnus to provide even more benefits for customers
developing for embedded targets. These features are guaranteed order of
initialization at startup, and selective linking.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-916531"></a>Initialization prioritization
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-919421"></a>In C++, you can define static
and global objects with constructors, or initialize static and global variables
from a function. This means that the constructors or functions are run
before the rest of your program starts. However, when you have these objects
spread over multiple files, the C++ standard does not specify the order
in which they are initialized, and for all practical purposes the order
is random. For an embedded system, this can be a problem, as you may want
to ensure that a static scheduler object is initialized before static threads
can attach to it, or that devices are initialized before they are used.
GNUPro solves this problem by allowing you to define a priority when the
static or global is declared. The following example shows the syntax:</p>

<blockquote><a NAME="pgfId-919422"></a><font face="Courier New,Courier"><font size=-1>static
object_t myobj __attribute__((init_priority (30000) ));</font></font></blockquote>

<p CLASS="Body"><a NAME="pgfId-919430"></a>The syntax is slightly different
if the object takes any arguments to its constructor:</p>

<blockquote><a NAME="pgfId-919431"></a><font face="Courier New,Courier"><font size=-1>static
object_t myobj __attribute__((init_priority (30000) )) = object_t(arg1,
arg2);</font></font></blockquote>

<p CLASS="Body"><a NAME="pgfId-916536"></a>The numeric priority can be
from 1 to 65535, with 1 being the highest priority, and 65535 being the
lowest. The default priority for objects without this attribute is 65535.
Constructors with a higher priority are guaranteed execution before constructors
with lower priority.</p>


<p CLASS="Body"><a NAME="pgfId-916537"></a>In all cases, you must provide
the argument '<tt>-finit-priority</tt>' to the compiler on its command-line
for it to recognize this attribute when you are compiling your C++ source
files.

<p CLASS="Body"><a NAME="pgfId-916538"></a>If you are using eCos, be warned
that eCos uses initialization priorities internally. Ensure you choose
an appropriate priority level so that other eCos subsystems will have initialized
before you refer to them in your own constructor.
<h3 CLASS="Heading2">
<a NAME="pgfId-916540"></a>Selective linking
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-916541"></a>When writing C and C++ code,
it is sometimes natural to include more than one function in a source file.
For example in C++, it is common to have all methods for a particular class
contained in the same C++ source file. However, there is a drawback that,
conventionally, if you use just one of these functions, then all the functions
defined in that file also get included in the final executable image. For
an embedded system, this can substantially and unnecessarily increase the
size of the final image stored in ROM, or loaded into RAM when debugging.</p>


<p CLASS="Body"><a NAME="pgfId-916542"></a>The GNUPro C and C++ compilers
can now optionally remove these unnecessary functions from the final image.
They also ensure that any shared global data is removed that is only referenced
by functions that are removed. This can be done by including the options
'<tt>-ffunction-sections</tt>' and '<tt>-fdata-sections</tt>' on the command-line,
when you invoke the C or C++ compiler. The '<tt>-ffunction-sections</tt>'
option removes unnecessary functions, and the '<tt>-fdata-sections</tt>'
option removes unnecessary data.

<p CLASS="Body"><a NAME="pgfId-916543"></a>In addition, when classes define
virtual methods in C++, it is possible to remove any unused methods from
the final image by passing the option '<tt>-fvtable-gc</tt>' to the C++
compiler on its command-line.

<p CLASS="Body"><a NAME="pgfId-930667"></a>In all cases, you must also
supply a command-line option when linking. If invoking the linker ld directly,
use '<tt>--gc-sections</tt>' on its command-line; alternatively, if you
are using the preferred method of linking your executable, using the form:
<blockquote>
<p CLASS="CodeExample"><a NAME="pgfId-930668"></a><font face="Courier New,Courier"><font size=-1>gcc
-o <i>&lt;program name> &lt;file1></i>.o<i> &lt;file2></i>.o</font></font></p>
</blockquote>

<p CLASS="Body"><a NAME="pgfId-930669"></a>then also pass the option
'<tt>-Wl,--gc-sections</tt>' on the compiler command-line, for example:</p>

<blockquote>
<p CLASS="CodeExample"><a NAME="pgfId-919439"></a><font face="Courier New,Courier"><font size=-1>gcc
-o prog f1.o f2.o -Wl,--gc-sections</font></font></p>
</blockquote>

<h2 CLASS="Heading1">
<a NAME="pgfId-461254"></a><a NAME="_Toc442250439"></a><a NAME="_Toc395075402"></a><a NAME="_Toc415038407"></a>ABI
Summary
<hr WIDTH="100%"></h2>

<p CLASS="Body"><a NAME="pgfId-916461"></a>The ARM tools adhere by default
to the APCS (ARM Procedure Call Standard). The Thumb tools adhere to the
TPCS (Thumb Procedure Call Standard). The following ABI summary is consistent
with both these standards.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-916464"></a><a NAME="_Toc442250440"></a>Data type sizes
and alignments
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-461258"></a>The following table shows
the size and alignment for all data types:</p>


<p CLASS="Body"><a NAME="pgfId-917160"></a>
<br>&nbsp;
<table BORDER >
<tr>
<td>
<p CLASS="CellHeading"><a NAME="pgfId-918007"></a><b>Type</b></p>
</td>

<td>
<p CLASS="CellHeading"><a NAME="pgfId-918009"></a><b>Size (bytes)</b></p>
</td>

<td>
<p CLASS="CellHeading"><a NAME="pgfId-918011"></a><b>Alignment (bytes)</b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918013"></a><tt>char</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918015"></a>1 byte</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918017"></a>1 byte</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918019"></a><tt>short</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918021"></a>2 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918023"></a>2 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918025"></a><tt>int</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918027"></a>4 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918029"></a>4 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-931870"></a><font face="Courier New,Courier">unsigned</font></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-931872"></a>4 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-931874"></a>4 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918037"></a><tt>long</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918039"></a>4 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918041"></a>4 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918043"></a><tt>long long</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918045"></a>8 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918047"></a>8 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918049"></a><tt>float</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918051"></a>4 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918053"></a>4 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918055"></a><tt>double</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918057"></a>8 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918059"></a>8 bytes</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-918061"></a>pointer</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918063"></a>4 bytes</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-918065"></a>4 bytes</p>
</td>
</tr>
</table>

<ul>
<li CLASS="Bullet2">
<a NAME="pgfId-931876"></a>Alignment within aggregates (structures and
unions) is as above, with padding added if needed</li>

<li CLASS="Bullet2">
<a NAME="pgfId-931877"></a>Aggregates have alignment equal to that of their
most aligned member</li>

<li CLASS="Bullet2">
<a NAME="pgfId-931878"></a>Aggregates have sizes which are a multiple of
their alignment</li>
</ul>

<h3 CLASS="Heading2">
<a NAME="pgfId-928375"></a>Subroutine calls
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-928377"></a>The following describes the
calling conventions for subroutine calls. The first table outlines the
registers used for passing parameters. The second table outlines other
register usage.</p>


<p CLASS="Body"><a NAME="pgfId-931988"></a>
<br>&nbsp;
<table BORDER >
<tr>
<td>
<p CLASS="CellHeading"><a NAME="pgfId-931981"></a><b>Parameter registers:</b></p>
</td>

<td>
<p CLASS="CellHeading"><a NAME="pgfId-931983"></a><b>ARM</b></p>
</td>

<td>
<p CLASS="CellHeading"><a NAME="pgfId-938674"></a><b>Thumb</b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-931985"></a>General-purpose</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-931987"></a><tt>r0-r3</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938692"></a><tt>r0-r3</tt></p>
</td>
</tr>
</table>


<p CLASS="Body"><a NAME="pgfId-932054"></a>
<br>&nbsp;
<table BORDER >
<tr>
<td>
<p CLASS="CellHeading"><a NAME="pgfId-932027"></a><b>Register usage:</b></p>
</td>

<td>
<p CLASS="CellHeading"><a NAME="pgfId-932029"></a><b>ARM</b></p>
</td>

<td>
<p CLASS="CellHeading"><a NAME="pgfId-938678"></a><b>Thumb</b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932031"></a>Volatile</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932033"></a><tt>r0-r3, r12</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938698"></a><tt>r0-r3</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932035"></a>Non-volatile</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932037"></a><tt>r4-r10</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938700"></a><tt>r4-r6</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932039"></a>Frame pointer</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932041"></a><tt>r11</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938702"></a><tt>r7, r11</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932043"></a>Stack pointer</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932045"></a><tt>r13</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938704"></a><tt>r13</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932047"></a>Return address</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932049"></a><tt>r14</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938706"></a><tt>r14</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932051"></a>Program counter</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932053"></a><tt>r15</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-938708"></a><tt>r15</tt></p>
</td>
</tr>
</table>

<ul>
<li CLASS="Bullet2">
<a NAME="pgfId-932062"></a>Structures that are less than or equal to 32
bits in length are passed as values.</li>

<li CLASS="Bullet2">
<a NAME="pgfId-938871"></a>Structures that are greater than 32 bits in
length are passed as pointers.</li>
</ul>

<p CLASS="Body"><a NAME="pgfId-939131"></a>The following table describes
the APCS and TPCS names for the general purpose registers.</p>


<p CLASS="Body"><a NAME="pgfId-939132"></a>The names are presented in the
format: &lt;Raw register name>, &lt;APCS name>

<p CLASS="Body"><a NAME="pgfId-939108"></a>
<br>&nbsp;
<table BORDER >
<tr>
<th COLSPAN="4">
<p CLASS="CellHeading"><a NAME="pgfId-939441"></a>APCS and TPCS names
for the general registers</p>
</th>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939449"></a><tt>r0, a1</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939451"></a><tt>r1, a2</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939453"></a><tt>r2, a3</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939455"></a><tt>r3, a4</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939457"></a><tt>r4, v1</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939459"></a><tt>r5, v2</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939461"></a><tt>r6, v3</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939463"></a><tt>r7, v4</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939465"></a><tt>r8, v5</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939467"></a><tt>r9, v6 </tt>and<tt>
sb</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939469"></a><tt>r10, v7 and sl&nbsp;</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939471"></a><tt>r11, fp</tt></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-939473"></a><tt>r12, ip</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939475"></a><tt>r13, sp</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939477"></a><tt>r14, lr</tt></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-939479"></a><tt>r15, pc</tt></p>
</td>
</tr>
</table>

<h6 CLASS="BodyListFollow2">
<a NAME="pgfId-938755"></a></h6>

<h3 CLASS="Heading2">
<a NAME="pgfId-461384"></a><a NAME="_Toc395075405"></a><a NAME="_Toc415038408"></a><a NAME="_Toc442250442"></a>The
Stack Frame
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-461385"></a>This section describes the
ARM and Thumb stack frame:</p>

<ul>
<li CLASS="Bullet">
<a NAME="pgfId-461386"></a>The stack grows downwards from high addresses
to low addresses.</li>

<li CLASS="Bullet">
<a NAME="pgfId-461387"></a>A leaf function need not allocate a stack frame
if it does not need one.</li>

<li CLASS="Bullet">
<a NAME="pgfId-461388"></a>A frame pointer need not be allocated.</li>

<li CLASS="Bullet">
<a NAME="pgfId-461389"></a>The stack pointer shall always be aligned to
4-byte boundaries.</li>

<li CLASS="Bullet">
<a NAME="pgfId-932071"></a>The stack pointer always points to the lowest
addressed word currently stored on the stack.</li>
</ul>

<p CLASS="BodyListFollow"><a NAME="pgfId-932231"></a>Stack frames for
functions that take a fixed number of arguments look like this:</p>


<p CLASS="Body"><a NAME="pgfId-932154"></a><img SRC="ARM_COMBO_ch01-2.gif" height=311 width=379>

<p CLASS="BodyListFollow"><a NAME="pgfId-932249"></a>Stack frames for functions
that take a variable number of arguments look like this:

<p CLASS="BodyListFollow"><a NAME="pgfId-932269"></a><img SRC="ARM_COMBO_ch01-3.gif" height=370 width=360>
<h3 CLASS="Heading2">
<a NAME="pgfId-928878"></a>C Language Calling Conventions
<hr WIDTH="100%"></h3>

<h4 CLASS="Heading3">
<a NAME="pgfId-932398"></a>Argument Representation</h4>

<p CLASS="Body"><a NAME="pgfId-932399"></a>A floating-point value occupies
one, two, or three words, as appropriate to its type. Floating point values
are encoded in IEEE 754 format, with the most significant word of a double
having the lowest address.</p>


<p CLASS="Label"><a NAME="pgfId-932400"></a><b><font size=+1>Note:&nbsp;<a NAME="pgfId-932401"></a></font></b>When
targetting little-endian ARMs, the words that make up a double will be
stored in big-endian order, while the bytes inside each word will be stored
in little-endian order..

<p CLASS="Body"><a NAME="pgfId-932402"></a>The C compiler widens arguments
of type float to type double to support inter-working between ANSI C and
classic C.

<p CLASS="Body"><a NAME="pgfId-932403"></a>Char, short, pointer and other
integral values occupy one word in an argument list. Character and short
values are widened by the C compiler during argument marshalling.

<p CLASS="Body"><a NAME="pgfId-932404"></a>A structure always occupies
an integral number of words (unless this is overridden by the '<tt>-mstructure-size-boundry</tt>'
command line option).
<h4 CLASS="Heading3">
<a NAME="pgfId-932405"></a>Argument List Collation</h4>

<p CLASS="Body"><a NAME="pgfId-932406"></a>Argument values are collated
in the order written in the source program</p>


<p CLASS="Body"><a NAME="pgfId-932407"></a>The first four words of the
argument values are loaded into '<tt>a1</tt>' through '<tt>a4</tt>', and
the remainder are pushed on to the stack in reverse order (so that arguments
later in the argument list have higher addresses than those earlier in
the argument list). As a consequence, a floating-point value can be passed
in integer registers, or even split between an integer register and the
stack.
<h3 CLASS="Heading2">
<a NAME="pgfId-932408"></a>Function Return Values
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-932409"></a>The following sections describe
how different data types are returned.</p>

<h4 CLASS="Heading3">
<a NAME="pgfId-932410"></a>Floats and Integer-like values</h4>

<p CLASS="Body"><a NAME="pgfId-932411"></a>Floats and integer-like values
are returned in register '<tt>r0</tt>'.</p>


<p CLASS="Body"><a NAME="pgfId-932412"></a>A type is integer-like if its
size is less than or equal to one word and if the type is a structure,
union or array, then all of its addressable sub-fields must have an offset
of zero.

<p CLASS="Body"><a NAME="pgfId-932413"></a>For example:
<blockquote><a NAME="pgfId-932414"></a><font face="Courier New,Courier"><font size=-1>struct
{int a:8, b:8, c:8, d:8;}</font></font></blockquote>

<p CLASS="Body"><a NAME="pgfId-932415"></a>is integer-like, as is;</p>

<blockquote>
<p CLASS="CodeExample"><a NAME="pgfId-932416"></a><font face="Courier New,Courier"><font size=-1>union
{int i; char*p;}</font></font></p>
</blockquote>

<p CLASS="Body"><a NAME="pgfId-932417"></a>but</p>

<blockquote>
<p CLASS="CodeExample"><a NAME="pgfId-932418"></a><font face="Courier New,Courier"><font size=-1>struct
{char A; char B; char c; char D;}</font></font></p>
</blockquote>

<p CLASS="Body"><a NAME="pgfId-932483"></a>is not, because it is possible
to take the address of fields B, C or D, and their offsets from the start
of the structure are not zero.</p>

<h4 CLASS="Heading3">
<a NAME="pgfId-932487"></a>Doubles and 'long long' integers</h4>

<p CLASS="Body"><a NAME="pgfId-932484"></a>Doubles and '<tt>long long</tt>'
integers are returned in registers '<tt>r0</tt>' and '<tt>r1</tt>'. For
doubles '<tt>r0</tt>' always contains the most significant word of the
double. For '<tt>long long</tt>' values '<tt>r0</tt>' only contains the
most significant word if the target is big-endian.</p>

<h4 CLASS="Heading3">
<a NAME="pgfId-932423"></a>Other values</h4>

<p CLASS="Body"><a NAME="pgfId-932424"></a>All other values are returned
by placing them into a suitably sized area of memory provided for this
purpose by the function's caller. A pointer to this area of memory is passed
to the function as a hidden first argument, generated at compile time.
For example:</p>

<blockquote><a NAME="pgfId-932425"></a><font face="Courier New,Courier"><font size=-1>LargeType
t;</font></font>
<br><a NAME="pgfId-932426"></a><font face="Courier New,Courier"><font size=-1>t
= func(arg);</font></font></blockquote>

<p CLASS="Body"><a NAME="pgfId-932427"></a>is implemented as:</p>

<blockquote><a NAME="pgfId-932428"></a><font face="Courier New,Courier"><font size=-1>LargeType
t;</font></font>
<br><a NAME="pgfId-932429"></a><font face="Courier New,Courier"><font size=-1>(void)
func(&amp;t,arg);</font></font></blockquote>

<h2 CLASS="Heading1">
<a NAME="pgfId-918674"></a><a NAME="_Toc415038410"></a><a NAME="_Toc442250446"></a>Assembler
<hr WIDTH="100%"></h2>

<p CLASS="Body"><a NAME="pgfId-918676"></a><a NAME="_Toc415038411"></a>This
section describes ARM-specific features of the GNUPro Assembler.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-461421"></a>ARM-specific command-line options
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-920093"></a>For a list of available generic
assembler options, refer to "Command-Line Options" in <i>Using AS</i> in
<b><i>GNUPro
Utilities</i></b>.</p>

<blockquote><a NAME="pgfId-935115"></a><tt>-m[arm][1|2|3|6|7[xx][t][[d]m]|8[10]|9[20][tdmi]]</tt>
<br><a NAME="pgfId-935117"></a><tt>-mstrongarm[110[0]]</tt></blockquote>

<blockquote>
<blockquote>Select processor variant.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932505"></a><tt>-m[arm]v[2|2a|3|3m|4|4t]</tt></p>

<blockquote>Select architecture variant.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938475"></a><tt>-mthumb</tt></p>

<blockquote>Only allow Thumb instructions.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938477"></a><tt>-mall</tt></p>

<blockquote>Allow any instruction.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-932512"></a><tt>-mfpa10</tt></p>

<blockquote>Select the v1.0 floating point architecture.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932514"></a><tt>-mfpa11</tt></p>

<blockquote>Select the v1.1 floating point architecture.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932516"></a><tt>-mfpe-old</tt></p>

<blockquote>Don't allow floating-point multiple instructions.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932518"></a><tt>-mno-fpu</tt></p>

<blockquote>Don't allow any floating-point instructions.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932520"></a><tt>-mthumb-interwork</tt></p>

<blockquote>Mark the assembled code as supporting inter-working.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932523"></a><tt>-mapcs-32</tt></p>

<blockquote>Mark the code as supporting the 26 bit variant of the ARM Procedure
calling standard. This is the default.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-938482"></a><tt>-mapcs-26</tt></p>

<blockquote>Mark the code as supporting the 26 bit variant of the ARM Procedure
calling standard.

<p CLASS="BodyListFollow"><a NAME="pgfId-938489"></a><b><i>This option
is not supported for use with eCos.</i></b></blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-932527"></a><tt>-EB</tt></p>

<blockquote>Assemble code for a big endian CPU.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-932529"></a><tt>-EL</tt></p>

<blockquote>Assemble code for a little endian CPU. This is the default.</blockquote>
</blockquote>

<h3 CLASS="Heading2">
<a NAME="pgfId-461426"></a><a NAME="wednesday"></a><a NAME="_Toc415038412"></a><a NAME="_Toc442250448"></a>Syntax
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-932553"></a>The ARM syntax is based on
the syntax in the <b><i>Advanced RISC Machine Architecture Reference Manual</i></b>.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-932554"></a>Special characters
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-932555"></a>Assembler comments start with
the '<tt>@</tt>' (at symbol) and extend to the end of the line.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-930616"></a><a NAME="_Ref395073228"></a><a NAME="_Ref395073286"></a><a NAME="_Ref395073825"></a><a NAME="_Toc413668801"></a><a NAME="_Toc442250449"></a><a NAME="_Toc415038413"></a><a NAME="_Toc442250450"></a>Register
names
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-932593"></a>These are the supported register
names, in the format:</p>


<p CLASS="Body"><a NAME="pgfId-932879"></a>{'<font face="Courier New,Courier">&lt;name></font>',
&lt;register number>}
<br>&nbsp;
<table BORDER >
<tr>
<th COLSPAN="4">
<p CLASS="CellHeading"><a NAME="pgfId-932840"></a>General registers</p>
</th>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932848"></a>{'<tt>r0</tt>', 0}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932850"></a>{'<tt>r1</tt>', 1}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932852"></a>{'<tt>r2</tt>', 2}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932854"></a>{'<tt>r3</tt>', 3}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932856"></a>{'<tt>r4</tt>', 4}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932858"></a>{'<tt>r5</tt>', 5}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932860"></a>{'<tt>r6</tt>', 6}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932862"></a>{'<tt>r7</tt>', 7}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932864"></a>{'<tt>r8</tt>', 8}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932866"></a>{'<tt>r9</tt>', 9}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932868"></a>{'<tt>r10</tt>', 10}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932870"></a>{'<tt>r11</tt>', 11}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932872"></a>{'<tt>r12</tt>', 12}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932874"></a>{'<tt>r13</tt>', 13},</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932876"></a>{'<tt>r14</tt>', 14},</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932878"></a>{'<tt>r15</tt>', 15}</p>
</td>
</tr>
</table>


<p CLASS="Body"><a NAME="pgfId-932929"></a>
<br>&nbsp;
<table BORDER >
<tr>
<th COLSPAN="4">
<p CLASS="CellHeading"><a NAME="pgfId-932882"></a>APCS and TPCS names
for the general registers</p>
</th>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932890"></a>{'<tt>a1</tt>', 0}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932892"></a>{'<tt>a2</tt>', 1}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932894"></a>{'<tt>a3</tt>', 2}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932896"></a>{'<tt>a4</tt>', 3}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932898"></a>{'<tt>v1</tt>', 4}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932900"></a>{'<tt>v2</tt>', 5}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932902"></a>{'<tt>v3</tt>', 6}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932904"></a>{'<tt>v4</tt>', 7}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932906"></a>{'<tt>v5</tt>', 8}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932908"></a>{'<tt>v6</tt>', 9}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932910"></a>{'<tt>sb</tt>', 9}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932912"></a>{'<tt>v7</tt>', 10}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932914"></a>{'<tt>sl</tt>', 10}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932916"></a>{'<tt>fp</tt>', 11}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932918"></a>{'<tt>ip</tt>', 12}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932920"></a>{'<tt>sp</tt>', 13}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-932938"></a>{'<tt>lr</tt>', 14}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932924"></a>{'<tt>pc</tt>', 15}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932926"></a></p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-932928"></a></p>
</td>
</tr>
</table>


<p CLASS="Body"><a NAME="pgfId-933270"></a>
<br>&nbsp;
<table BORDER >
<tr>
<th COLSPAN="4">
<p CLASS="CellHeading"><a NAME="pgfId-933274"></a>Floating point registers</p>
</th>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933282"></a>{'<tt>f0</tt>',16}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933284"></a>{'<tt>f1</tt>', 17}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933286"></a>{'<tt>f2</tt>', 18}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933288"></a>{'<tt>f3</tt>', 19}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933290"></a>{'<tt>f4</tt>',20}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933292"></a>{'<tt>f5</tt>', 21}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933294"></a>{'<tt>f6</tt>', 22}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933296"></a>{'<tt>f7</tt>', 23}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933298"></a>{'<tt>c0</tt>',32}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933300"></a>{'<tt>c1</tt>', 33}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933302"></a>{'<tt>c2</tt>', 34}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933304"></a>{'<tt>c3</tt>', 35}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933306"></a>{'<tt>c4</tt>',36}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933308"></a>{'<tt>c5</tt>', 37}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933310"></a>{'<tt>c6</tt>', 38}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933312"></a>{'<tt>c7</tt>', 39}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933314"></a>{'<tt>c8</tt>',40}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933316"></a>{'<tt>c9</tt>', 41}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933318"></a>{'<tt>c10</tt>', 42}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933320"></a>{'<tt>c11</tt>', 43}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933322"></a>{'<tt>c12</tt>',44}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933324"></a>{'<tt>c13</tt>', 45}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933326"></a>{'<tt>c14</tt>', 46}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933328"></a>{'<tt>c15</tt>', 47}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933330"></a>{'<tt>cr0</tt>',32}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933332"></a>{'<tt>cr1</tt>', 33}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933334"></a>{'<tt>cr2</tt>', 34}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933336"></a>{'<tt>cr3</tt>', 35}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933338"></a>{'<tt>cr4</tt>',36}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933340"></a>{'<tt>cr5</tt>', 37}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933342"></a>{'<tt>cr6</tt>', 38}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933344"></a>{'<tt>cr7</tt>', 39}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933346"></a>{'<tt>cr8</tt>',40}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933348"></a>{'<tt>cr9</tt>', 41}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933350"></a>{'<tt>cr10</tt>', 42}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933352"></a>{'<tt>cr11</tt>', 43}</p>
</td>
</tr>

<tr>
<td>
<p CLASS="CellBody"><a NAME="pgfId-933354"></a>{'<tt>cr12</tt>',44}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933356"></a>{'<tt>cr13</tt>', 45}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933358"></a>{'<tt>cr14</tt>', 46}</p>
</td>

<td>
<p CLASS="CellBody"><a NAME="pgfId-933360"></a>{'<tt>cr15</tt>', 47}</p>
</td>
</tr>
</table>

<h3 CLASS="Heading2">
<a NAME="pgfId-932930"></a>Floating point
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-933403"></a>The assembler supports hardware
floating point, but the compiler does not.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-933404"></a>Opcodes
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-933405"></a>For detailed information on
the ARM machine instruction set, see <b><i>Advanced RISC Machines Architectural
Reference Manual</i></b>. The GNU Assembler (GAS) implements all the standard
opcodes.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-933406"></a>Synthetic Instructions
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-933407"></a>The assembler supports the
following synthesized instructions (pseudo instructions, which correspond
to two or more actual machine instructions).</p>

<blockquote><a NAME="pgfId-933408"></a><tt>.arm</tt></blockquote>

<blockquote>
<blockquote>The following code uses the ARM instruction set.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-933410"></a><tt>.thumb</tt></p>

<blockquote>
<p CLASS="BodyHang1">The following code uses the Thumb instruction set.</p>
</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-933413"></a><tt>.code 16</tt></p>

<blockquote>An alias for .thumb</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-933416"></a>.<tt> code 32</tt></p>

<blockquote>An alias for .arm</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-933418"></a><tt>.force_thumb</tt></p>

<blockquote>The following code uses the Thumb instruction set, and should
be assembled even if the target processor does not support Thumb instructions.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-933421"></a><tt>.thumb_func</tt></p>

<blockquote>The following label is the name of function which has been
encoded using Thumb instructions, rather than ARM instructions.</blockquote>

<p CLASS="BodyHang1"><a NAME="pgfId-933424"></a><tt>.ltorg</tt></p>

<blockquote>Start a literal pool.</blockquote>
</blockquote>

<h3 CLASS="Heading2">
<a NAME="pgfId-933551"></a>ARM-specific assembler error messages
<hr WIDTH="100%"></h3>

<blockquote><a NAME="pgfId-933573"></a><b><tt>Error: Unrecognized opcode</tt></b>
<blockquote>This instruction is misspelled or there is a syntax error somewhere.</blockquote>
</blockquote>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-933575"></a><b><tt>Warning: operand
out of range</tt></b></p>

<blockquote>An immediate value was specified that is too large for the
instruction</blockquote>
</blockquote>

<h2 CLASS="Heading1">
<a NAME="pgfId-922803"></a><a NAME="_Toc442250453"></a>Linker
<hr WIDTH="100%"></h2>

<p CLASS="Body"><a NAME="pgfId-922804"></a>eCos generates linker scripts
appropriate for the exact eCos configuration you have chosen. Instructions
on how to use this linker script are provided in the manual <b><i>Getting
Started with eCos</i></b>.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-922806"></a>ARM-specific command-line options
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-461499"></a>For a list of available generic
linker options, refer to "Linker scripts" in <i>Using LD</i> in <b><i>GNUPro
Utilities</i></b>. There are no ARM-specific command-line linker options.</p>

<h2 CLASS="Heading1">
<a NAME="pgfId-930095"></a><a NAME="_Ref372526299"></a><a NAME="_Ref372526330"></a><a NAME="_Toc442250456"></a>Debugger
<hr WIDTH="100%"></h2>

<p CLASS="Body"><a NAME="pgfId-933532"></a>This section describes ARM-specific
features of the GNUPro Debugger.</p>


<p CLASS="Body"><a NAME="pgfId-933533"></a>The following instructions connect
GDB to the remote target board. To load your program onto the target board,
build eCos for the hardware with RAM startup. Provided the board is fitted
with CygMon ROMs, or GDB loader stub ROMs, you may connect to the target
board in GDB using the command '<tt>target remote</tt> <font face="Courier New,Courier"><font size=-1><i>&lt;devicename></i>'</font></font>
where '<i><font face="Courier New,Courier"><font size=-1>&lt;devicename></font></font></i>'
will be a serial device such as '<tt>com2</tt>' (Windows NT) or '<tt>/dev/ttyS1</tt>'
(Unix). Then load the code onto the target board by typing '<font face="Courier New,Courier"><font size=-1>load</font></font>'.
After being downloaded, the program can be executed.

<p CLASS="Body"><a NAME="pgfId-935356"></a>Little-endian targets may require
the use of the '<tt>set endian little</tt>' command to connect correctly.
It may also be necessary to change the default baud rate before connecting
to the target board by the using the '<font face="Courier New,Courier"><font size=-1>set
remotebaud <i>&lt;baudrate></i></font></font>' command.

<p CLASS="Label"><a NAME="pgfId-933534"></a><b><font size=+1>Note: </font></b>When
using the remote target, GDB does not accept the '<tt>run</tt>' command.
However, since downloading the program has the side effect of setting the
PC to the start address, you can start your program by typing '<tt>continue</tt>'
(the letter '<tt>c</tt>' works as a shortcut for the '<tt>continue</tt>'
command).
<h3 CLASS="Heading2">
<a NAME="pgfId-922901"></a>ARM-specific command-line options
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-461516"></a>For the available generic
debugger options, refer to <i>Debugging with GDB</i> in <b><i>GNUPro Debugging
Tools</i></b>. There are no ARM-specific debugger command-line options.</p>

<h3 CLASS="Heading2">
<a NAME="pgfId-922983"></a>Debugging programs with multiple threads
<hr WIDTH="100%"></h3>

<p CLASS="Body"><a NAME="pgfId-922984"></a>Programs with multiple threads
can be debugged using either the graphic user interface to GDB, Insight<sup><font size=-2>TM</font></sup>
or the GDB command line interface. The following describes how to debug
multiple threads using the GDB command line.</p>


<p CLASS="Body"><a NAME="pgfId-922985"></a>In some operating systems, such
as eCos, a single program may have more than one thread of execution. The
precise semantics of threads differ from one operating system to another,
but in general the threads of a single program are akin to multiple processes,
except that they share one address space (that is, they can all examine
and modify the same variables). On the other hand, each thread has its
own registers and execution stack, and perhaps private memory.

<p CLASS="Body"><a NAME="pgfId-922986"></a>GDB provides the following functions
for debugging multi-thread programs
<ul>
<li CLASS="Bullet">
<a NAME="pgfId-922987"></a><tt>'</tt><font face="Courier New,Courier"><font size=-1>thread
<i>&lt;threadno></i></font></font>',
a command to switch among threads</li>

<li CLASS="Bullet">
<a NAME="pgfId-923090"></a><tt>'info threads</tt> ', a command to inquire
about existing threads</li>

<li CLASS="Bullet">
<a NAME="pgfId-923091"></a><tt>'thread apply [</tt><i><font face="Courier New,Courier"><font size=-1>&lt;threadno></font></font></i><tt>][all]
args</tt>', a command to apply a command to a list of threads</li>

<li CLASS="Bullet">
<a NAME="pgfId-922990"></a>thread-specific breakpoints</li>
</ul>

<p CLASS="Body"><a NAME="pgfId-922991"></a>The GDB thread-debugging facility
allows you to observe all threads while your program runs, but whenever
GDB takes control, one thread in particular is always the focus of debugging.
This thread is called the current thread. Debugging commands show program
information from the perspective of the current thread.</p>


<p CLASS="Body"><a NAME="pgfId-922992"></a>For debugging purposes, GDB
associates its own thread number, always a single integer, with each thread
in your program.
<blockquote><a NAME="pgfId-922993"></a><tt>info threads</tt></blockquote>

<blockquote>
<blockquote>Display a summary of all threads currently in your program.
GDB displays for each thread (in the following order):
<ol>
<li CLASS="NumberedSideHead">
<a NAME="pgfId-922995"></a>The thread number assigned by GDB</li>

<li CLASS="NumberedSideHead">
<a NAME="pgfId-922996"></a>The target system's thread I.D.</li>

<li CLASS="NumberedSideHead">
<a NAME="pgfId-922997"></a>The current stack frame summary for that thread</li>
</ol>
</blockquote>
</blockquote>

<blockquote>
<blockquote><a NAME="pgfId-923150"></a>An asterisk '<tt>*</tt>' to the
left of the GDB thread number indicates the current thread. Use the following
example for clarity.</blockquote>
</blockquote>

<center><table WIDTH="600" >
<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923172"></a><font face="Courier New,Courier"><font size=-1><b>(gdb)
</b>info
threads</font></font></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923174"></a><b><font face="Courier New,Courier"><font size=-1>*
2 thread 2 breakme ()</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923176"></a><b><font face="Courier New,Courier"><font size=-1>at
/eCos/packages/kernel/v1_1/tests/thread_gdb.c:91</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923178"></a><b><font face="Courier New,Courier"><font size=-1>Name:
controller, State: running, Priority: 0, More: &lt;none></font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923180"></a><b><font face="Courier New,Courier"><font size=-1>1
thread 1 Cyg_HardwareThread::thread_entry (thread=0x1111aaa2)</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923182"></a><b><font face="Courier New,Courier"><font size=-1>at
/eCos/packages/kernel/v1_1/src/common/thread.cxx:68</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923184"></a><b><font face="Courier New,Courier"><font size=-1>Name:
Idle Thread, State: running, Priority: 31, More: &lt;none></font></font></b></p>
</td>
</tr>
</table></center>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-923166"></a><font face="Courier New,Courier"><font size=-1>thread
<i>&lt;threadno></i></font></font></p>

<blockquote>Make thread number '<i><font face="Courier New,Courier"><font size=-1>&lt;threadno></font></font></i>'the
current thread. The command argument, '<i><font face="Courier New,Courier"><font size=-1>&lt;threadno></font></font></i>',
is the internal GDB thread number, as shown in the first field of the `info
threads' display. GDB responds by displaying the system identifier of the
thread you selected, and its current stack frame summary, as in the following
output.</blockquote>
</blockquote>

<center><table WIDTH="600" >
<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923220"></a><font face="Courier New,Courier"><font size=-1><b>(gdb)
</b>thread
2</font></font></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923222"></a><b><font face="Courier New,Courier"><font size=-1>[Switching
to thread 2]</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923224"></a><b><font face="Courier New,Courier"><font size=-1>#0
change_state (id=0, newstate=0 '\000')</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923226"></a><b><font face="Courier New,Courier"><font size=-1>at
/eCos/kernel/current/tests/bin_sem2.cxx:93</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923228"></a><b><font face="Courier New,Courier"><font size=-1>93
if (PHILO_LOOPS == state_changes++)&nbsp;</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923230"></a><b><font face="Courier New,Courier"><font size=-1>Current
language: auto; currently c++</font></font></b></p>
</td>
</tr>

<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923232"></a></p>
</td>
</tr>
</table></center>

<blockquote>
<p CLASS="BodyHang1"><a NAME="pgfId-923243"></a><font face="Courier New,Courier"><font size=-1>thread
apply [<i>&lt;threadno></i>][<i>&lt;all></i>]
<i>&lt;args></i></font></font></p>

<blockquote>
<p CLASS="BodyHang1">The thread apply command allows you to apply a command
to one or more threads. Specify the numbers of the threads that you want
affected with the command argument '<i><font face="Courier New,Courier"><font size=-1>&lt;threadno></font></font></i>',
where '<font face="Courier New,Courier"><font size=-1>&lt;threadno></font></font>'
is the internal GDB thread number, as shown in the first field of the '<tt>info
threads</tt>' display. To apply a command to all threads, use '<tt>thread
apply all args</tt>'.</p>
</blockquote>
</blockquote>

<p CLASS="Body"><a NAME="pgfId-923016"></a>Whenever GDB stops your program,
due to a breakpoint or a signal, it automatically selects the thread where
that breakpoint or signal happened.</p>


<p CLASS="Body"><a NAME="pgfId-923017"></a>When your program has multiple
threads, you can choose whether to set breakpoints on all threads, or on
a particular thread.
<blockquote>
<p CLASS="CodeExample"><a NAME="pgfId-923018"></a><font face="Courier New,Courier"><font size=-1>break
<i>&lt;linespec></i>thread
<i>&lt;threadno></i></font></font></p>
</blockquote>

<p CLASS="Body"><a NAME="pgfId-923248"></a>If '<i><font face="Courier New,Courier"><font size=-1>&lt;linespec></font></font></i>'
specifies source lines, then there are several ways of writing them. Use
the qualifier '<font face="Courier New,Courier"><font size=-1>thread <i>&lt;threadno></i></font></font>'
with a breakpoint command to specify that you only want GDB to stop the
program when a particular thread reaches this breakpoint. '<i>&lt;threadno></i>'
is one of the numeric thread identifiers assigned by GDB, shown in the
first column of the '<font face="Courier New,Courier"><font size=-1>info
threads</font></font>' display.</p>


<p CLASS="Body"><a NAME="pgfId-923020"></a>If you do not specify '<font face="Courier New,Courier"><font size=-1>thread
<i>&lt;threadno></i></font></font>'
when you set a breakpoint, the breakpoint applies to all threads of your
program.

<p CLASS="Body"><a NAME="pgfId-923021"></a>You can use the thread qualifier
on conditional breakpoints as well; in this case, place '<font face="Courier New,Courier"><font size=-1>thread
<i>&lt;threadno></i></font></font>'
before the breakpoint condition, as the following example shows.
<br>&nbsp;
<center><table WIDTH="600" >
<tr>
<td>
<p CLASS="CodeScreen2"><a NAME="pgfId-923262"></a><font face="Courier New,Courier"><font size=-1><b>(gdb)
</b>break
frik.c:13 thread 28 if bartab > lim</font></font></p>
</td>
</tr>
</table></center>


<p CLASS="Body"><a NAME="pgfId-923023"></a>Whenever your program stops
under GDB for any reason, all threads of execution stop; not just the current
thread. This allows you to examine the overall state of the program, including
switching between threads, without worrying that things may change.

<p CLASS="Body"><a NAME="pgfId-923024"></a>Conversely, whenever you restart
the program, all threads start executing. This is true even when single
stepping with commands like '<tt>step</tt>' or '<tt>next</tt>'. In particular,
GDB cannot single-step all threads in lockstep. Since thread scheduling
is up to your debugging target's operating system (not controlled by GDB),
other threads may execute more than one statement while the current thread
completes a single step. In general other threads stop in the middle of
a statement, rather than at a clean statement boundary, when the program
stops.

<p CLASS="Body"><a NAME="pgfId-923025"></a>You might even find your program
stopped in another thread after continuing or even single stepping. This
happens whenever some other thread runs into a breakpoint, a signal, or
an exception before the first thread completes whatever you requested.
<h4 CLASS="Heading3">
<a NAME="pgfId-923026"></a>SET SCHEDULER-LOCKING
<hr WIDTH="100%"></h4>

<p CLASS="Body"><a NAME="pgfId-923027"></a>For targets that support it,
GDB has a new command that helps to debug multi-threaded programs.</p>

<br>The '<tt>set scheduler-locking [on off step]</tt>' command allows the
GDB user to exert some control over how threads are scheduled while debugging.

<p CLASS="Body"><a NAME="pgfId-923029"></a>Normally GDB does not attempt
to interfere with thread scheduling. This means that in the default mode
('<tt>scheduler-locking off</tt>'), the current thread may be scheduled
out, and a different thread may begin running, at any time (as determined
by the native scheduler). For instance, you may give a GDB command such
as '<font face="Courier New,Courier"><font size=-1>step</font></font>'
or '<font face="Courier New,Courier"><font size=-1>finish</font></font>',
and when the command completes, you may be looking at a different thread.

<p CLASS="Body"><a NAME="pgfId-923030"></a>If you set the scheduler-locking
mode to '<tt>step</tt>', then GDB will try to interfere with the native
scheduler just enough to prevent another thread from popping up while you
debug. Other threads may get to run sometimes, but whenever a command such
as '<tt>step</tt>' or '<tt>finish</tt>' completes, you should be looking
at the same thread that was running before the command. Of course, if another
thread gets to run and hits a breakpoint, GDB will still switch you to
that thread (so if you don't want that to happen, then disable your breakpoints).

<p CLASS="Body"><a NAME="pgfId-923031"></a>For even greater (and more intrusive)
control over the thread scheduler, GDB provides the mode '<tt>scheduler-locking
on</tt>'. In this mode, the native scheduler is completely locked, and
no thread may run except the current one. Obviously this will radically
change the behavior of your program, and may lead to deadlock or other
unpleasant consequences, so use it with caution.
<br>&nbsp;

<p CLASS="Label"><a NAME="pgfId-923032"></a><b><font size=+1>Syntax:</font></b>
<blockquote><a NAME="pgfId-923033"></a><tt>set scheduler-locking [off on
step]</tt></blockquote>

<blockquote><a NAME="pgfId-923395"></a>Set mode for locking scheduler during
target execution.</blockquote>

<blockquote><a NAME="pgfId-923396"></a><tt>off</tt></blockquote>

<blockquote>
<blockquote><a NAME="pgfId-923397"></a>No locking (threads may preempt
at any time).</blockquote>
</blockquote>

<blockquote><a NAME="pgfId-923037"></a><tt>on</tt></blockquote>

<blockquote>
<blockquote><a NAME="pgfId-923335"></a>Full locking (no thread except the
current thread may run).</blockquote>
</blockquote>

<blockquote><a NAME="pgfId-923039"></a><tt>step</tt></blockquote>

<blockquote>
<blockquote><a NAME="pgfId-923336"></a>The scheduler is locked during every
single-step operation. In this mode, no other thread may run during a step
command. However, other threads may run while stepping over a function
call ('<tt>next</tt>').</blockquote>
</blockquote>

<blockquote><a NAME="pgfId-922981"></a></blockquote>

<p CLASS="Body"><a NAME="pgfId-461520"></a><a NAME="_Toc414871787"></a><a NAME="_Toc418677753"></a><a NAME="_Toc442250458"></a></p>

</body>
</html>
